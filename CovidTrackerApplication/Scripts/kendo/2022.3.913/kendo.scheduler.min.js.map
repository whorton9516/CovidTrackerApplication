{"version":3,"file":"kendo.scheduler.min.js","sources":["kendo.scheduler.js"],"sourcesContent":["(function(f, define) {\n    define('kendo.scheduler',[ \"kendo.dropdownlist\", \"kendo.editable\", \"kendo.multiselect\", \"kendo.window\", \"kendo.datetimepicker\", \"kendo.scheduler.recurrence\", \"kendo.scheduler.view\", \"kendo.scheduler.dayview\", \"kendo.scheduler.agendaview\", \"kendo.scheduler.monthview\", \"kendo.scheduler.timelineview\", \"kendo.scheduler.yearview\", \"kendo.dialog\", \"kendo.pane\", \"kendo.pdf\", \"kendo.switch\" ], f);\n})(function() {\n\nvar __meta__ = {\n    id: \"scheduler\",\n    name: \"Scheduler\",\n    category: \"web\",\n    description: \"The Scheduler is an event calendar.\",\n    depends: [ \"dropdownlist\", \"editable\", \"multiselect\", \"window\", \"datepicker\", \"datetimepicker\", \"scheduler.recurrence\", \"scheduler.view\" ],\n    features: [ {\n        id: \"scheduler-dayview\",\n        name: \"Scheduler Day View\",\n        description: \"Scheduler Day View\",\n        depends: [ \"scheduler.dayview\" ]\n    }, {\n        id: \"scheduler-agendaview\",\n        name: \"Scheduler Agenda View\",\n        description: \"Scheduler Agenda View\",\n        depends: [ \"scheduler.agendaview\" ]\n    }, {\n        id: \"scheduler-monthview\",\n        name: \"Scheduler Month View\",\n        description: \"Scheduler Month View\",\n        depends: [ \"scheduler.monthview\" ]\n    }, {\n        id: \"scheduler-timelineview\",\n        name: \"Scheduler Timeline View\",\n        description: \"Scheduler Timeline View\",\n        depends: [ \"scheduler.timelineview\" ]\n    }, {\n        id: \"scheduler-yearview\",\n        name: \"Scheduler Year View\",\n        description: \"Scheduler Year View\",\n        depends: [ \"scheduler.yearview\" ]\n    }, {\n        id: \"scheduler-mobile\",\n        name: \"Scheduler adaptive rendering\",\n        description: \"Support for adaptive rendering\",\n        depends: [ \"dialog\", \"pane\", \"switch\" ]\n    }, {\n        id: \"scheduler-pdf-export\",\n        name: \"PDF export\",\n        description: \"Export the scheduler events as PDF\",\n        depends: [ \"pdf\", \"drawing\" ]\n    }, {\n        id: \"scheduler-timezones\",\n        name: \"Timezones\",\n        description: \"Allow selecting timezones different than Etc/UTC\",\n        depends: [ \"timezones\" ]\n    }]\n};\n\n\n(function($, undefined) {\n    var kendo = window.kendo,\n        date = kendo.date,\n        MS_PER_DAY = date.MS_PER_DAY,\n        getDate = date.getDate,\n        getMilliseconds = kendo.date.getMilliseconds,\n        recurrence = kendo.recurrence,\n        keys = $.extend({ F10: 121 }, kendo.keys),\n        ui = kendo.ui,\n        Widget = ui.Widget,\n        DataBoundWidget = ui.DataBoundWidget,\n        STRING = \"string\",\n        Popup = ui.Popup,\n        Calendar = ui.Calendar,\n        DataSource = kendo.data.DataSource,\n        isPlainObject = $.isPlainObject,\n        extend = $.extend,\n        toString = Object.prototype.toString,\n        isArray = Array.isArray,\n        NS = \".kendoScheduler\",\n        CLICK = \"click\",\n        MOUSEDOWN = \"mousedown\",\n        TOUCHSTART = kendo.support.pointers ? \"pointerdown\" : \"touchstart\",\n        TOUCHMOVE = kendo.support.pointers ? \"pointermove\" : \"touchmove\",\n        TOUCHEND = kendo.support.pointers ? \"pointerup\" : \"touchend\",\n        MOUSEMOVE = kendo.support.mousemove,\n        CHANGE = \"change\",\n        PROGRESS = \"progress\",\n        ERROR = \"error\",\n        CANCEL = \"cancel\",\n        REMOVE = \"remove\",\n        RESET = \"resetSeries\",\n        SAVE = \"save\",\n        ADD = \"add\",\n        EDIT = \"edit\",\n        DISABLED = \"disabled\",\n        OPTION = \"option\",\n        FOCUSEDSTATE = \"k-focus\",\n        VIEWSSELECTOR = \".k-scheduler-views\",\n        INVERSECOLORCLASS = \"k-event-inverse\",\n        valueStartEndBoundRegex = /(?:value:start|value:end)(?:,|$)/,\n        TODAY = getDate(new Date()),\n        EXCEPTION_SEPARATOR = \",\",\n        OLD_EXCEPTION_SEPARATOR_REGEXP = /\\;/g,\n        RECURRENCE_EXCEPTION = \"recurrenceException\",\n        DELETECONFIRM = \"Are you sure you want to delete this event?\",\n        DELETERECURRING = \"Do you want to delete only this event occurrence or the whole series?\",\n        EDITRECURRING = \"Do you want to edit only this event occurrence or the whole series?\",\n        DELETERECURRINGCONFIRM = \"Are you sure you want to delete this event occurrence?\",\n        RESETSERIESCONFIRM = \"Are you sure you want to reset the whole series?\",\n        DELETESERIESCONFIRM = \"Are you sure you want to delete the whole series?\",\n        COMMANDBUTTONTMPL = '<button type=\"button\" class=\"k-button k-button-md k-rounded-md k-button-solid #=className#\" #=attr#><span class=\"k-button-text\">#=text#</span></button>',\n        VIEWS_DROPDOWN_TEMPLATE = kendo.template('' +\n            '<select aria-label=\"#= label #\" class=\"k-picker k-dropdown-list k-dropdown k-views-dropdown\" tabindex=\"-1\">' +\n                '#for (var view in views) {#' +\n                    '<option value=\"#= view #\">${views[view].title}</option>' +\n                '#}#' +\n            '</select>'\n        ),\n        TOOLBARTEMPLATE = kendo.template('' +\n            '<div class=\"k-scheduler-toolbar k-toolbar\" role=\"toolbar\">' +\n                '# if (pdf) { #' +\n                    '<button tabindex=\"-1\" class=\"k-button k-button-md k-rounded-md k-button-solid k-button-solid-base k-pdf\"><span class=\"k-button-icon k-icon k-i-file-pdf\"></span><span class=\"k-button-text\">${messages.pdf}</span></button>' +\n                '# } #' +\n                '<span class=\"k-scheduler-navigation k-button-group\">' +\n                    '<button tabindex=\"-1\" class=\"k-button k-button-md k-rounded-md k-button-solid k-button-solid-base k-nav-today\" title=\"${messages.today}\"><span class=\"k-button-text\">${messages.today}</span></button>' +\n                    '<button tabindex=\"-1\" class=\"k-button k-button-md k-rounded-md k-button-solid k-button-solid-base k-icon-button k-nav-prev\" title=\"${messages.previous}\" aria-label=\"${messages.previous}\"><span class=\"k-button-icon k-icon k-i-arrow-60-left\"></span></button>' +\n                    '<button tabindex=\"-1\" class=\"k-button k-button-md k-rounded-md k-button-solid k-button-solid-base k-icon-button k-nav-next\" title=\"${messages.next}\" aria-label=\"${messages.next}\"><span class=\"k-button-icon k-icon k-i-arrow-60-right\"></span></button>' +\n                '</span>' +\n                '<a tabindex=\"-1\" role=\"button\" href=\"\\\\#\" class=\"k-nav-current\" aria-live=\"polite\">' +\n                    '<span class=\"k-icon k-i-calendar\"></span>' +\n                    '<span class=\"k-sm-date-format\" data-#=ns#bind=\"text: formattedShortDate\"></span>' +\n                    '<span class=\"k-lg-date-format\" data-#=ns#bind=\"text: formattedDate\"></span>' +\n                '</a>' +\n                '<span class=\"k-spacer k-toolbar-spacer\"></span>' +\n                '# if (search) { #' +\n                    '<span class=\"k-scheduler-search k-textbox k-input k-input-md k-rounded-md k-input-solid\">' +\n                        '<input tabindex=\"-1\" autocomplete=\"off\" placeholder=\"${messages.search}\" title=\"${messages.search}\" class=\"k-input-inner k-scheduler-search-input k-input-inner\" />' +\n                        '<span class=\"k-input-suffix\"><span class=\"k-icon k-i-search\"></span></span>' +\n                    '</span>' +\n                '# } #' +\n                '# if (viewsCount === 1) { #' +\n                    '<a role=\"button\" tabindex=\"-1\" data-#=ns#name=\"#=view#\" href=\"\\\\#\" class=\"k-button k-button-md k-rounded-md k-button-solid k-button-solid-base k-icon-button k-scheduler-refresh\" aria-label=\"${messages.refresh}\">' +\n                        '<span class=\"k-button-icon k-icon k-i-reload\"></span>' +\n                    '</a>' +\n                '# } else { #' +\n                    '<span class=\"k-scheduler-views-wrapper\">' +\n                        '<span class=\"k-scheduler-views k-button-group\">' +\n                            '# for (var view in views) { #' +\n                                '<button tabindex=\"-1\" class=\"k-button k-button-md k-rounded-md k-button-solid k-button-solid-base k-view-#= view.toLowerCase() #\" data-#=ns#name=\"#=view#\"><span class=\"k-button-text\">${views[view].title}</span></button>' +\n                            '# } #' +\n                        '</span>' +\n                    '</span>' +\n                '# } #' +\n            '</div>'),\n        MOBILETOOLBARTEMPLATE = kendo.template('<div class=\"k-scheduler-toolbar k-toolbar\" role=\"toolbar\">' +\n            '<span class=\"k-scheduler-tools k-button-group\">' +\n                '# if (pdf) { #' +\n                    '<button tabindex=\"-1\" class=\"k-button k-button-md k-rounded-md k-button-solid k-button-solid-base k-icon-button k-pdf\"><span class=\"k-button-icon k-icon k-i-file-pdf\"></span></button>' +\n                '# } #' +\n                    '<button tabindex=\"-1\" class=\"k-button k-button-md k-rounded-md k-button-solid k-button-solid-base k-icon-button k-nav-calendar\"><span class=\"k-button-icon k-icon k-i-calendar\"></span></button>' +\n                \"# if (editable) { #\" +\n                    '<button tabindex=\"-1\" class=\"k-button k-button-md k-rounded-md k-button-solid k-button-solid-base k-icon-button k-create-event\"><span class=\"k-button-icon k-icon k-i-plus\"></span></button>' +\n                \"# } #\" +\n            '</span>' +\n            '<span class=\"k-spacer k-toolbar-spacer\"></span>' +\n            '# if (search) { #' +\n                '<span class=\"k-scheduler-search k-textbox k-input k-input-md k-rounded-md k-input-solid\">' +\n                    '<input tabindex=\"-1\" autocomplete=\"off\" placeholder=\"${messages.search}\" title=\"${messages.search}\" class=\"k-scheduler-search-input k-input-inner\" />' +\n                    '<span class=\"k-input-suffix\"><span class=\"k-icon k-i-search\"></span></span>' +\n                '</span>' +\n            '# } #' +\n            '#if(viewsCount === 1){#' +\n                '<a role=\"button\" tabindex=\"-1\" data-#=ns#name=\"#=view#\" href=\"\\\\#\" class=\"k-button k-button-md k-rounded-md k-button-solid k-button-solid-base k-icon-button k-scheduler-refresh\">' +\n                    '<span class=\"k-button-icon k-icon k-i-reload\"></span>' +\n                '</a>' +\n            '#} else {#' +\n                '<select tabindex=\"-1\" class=\"k-picker k-dropdown-list k-dropdown k-scheduler-mobile-views\">' +\n                    '#for(var view in views){#' +\n                        '<option class=\"k-view-#= view.toLowerCase() #\" value=\"#=view#\">${views[view].title}</option>' +\n                    '#}#' +\n                '</select>' +\n            '#}#' +\n            '</div>' +\n            '<div class=\"k-scheduler-toolbar k-toolbar\" role=\"toolbar\">' +\n                '<span class=\"k-scheduler-navigation\">' +\n                   '<button tabindex=\"-1\" class=\"k-button k-button-md k-rounded-md k-button-solid k-button-solid-base k-icon-button k-nav-prev\"><span class=\"k-button-icon k-icon k-i-arrow-chevron-left\"></span></button>' +\n                   '<span class=\"k-nav-current\">' +\n                        '<span class=\"k-m-date-format\" data-#=ns#bind=\"text: formattedMobileDate\"></span>' +\n                        '<span class=\"k-y-date-format\" data-#=ns#bind=\"text: formattedYear\"></span>' +\n                    '</span>' +\n                   '<button tabindex=\"-1\" class=\"k-button k-button-md k-rounded-md k-button-solid k-button-solid-base k-icon-button k-nav-next\"><span class=\"k-button-icon k-icon k-i-arrow-chevron-right\"></span></button>' +\n                '</span>' +\n            '</div>'),\n        MOBILEDATERANGEEDITOR = function(container, options) {\n            var attr = { name: options.field, title: options.title };\n            var isAllDay = options.model.isAllDay;\n            var dateTimeValidate = kendo.attr(\"validate\") + \"='\" + (!isAllDay) + \"'\";\n            var dateValidate = kendo.attr(\"validate\") + \"='\" + (!!isAllDay) + \"'\";\n\n            appendTimezoneAttr(attr, options);\n            appendValidDateValidator(attr, options);\n            appendDateCompareValidator(attr, options);\n\n            $('<input type=\"datetime-local\" required ' + kendo.attr(\"type\") + '=\"datetime-local\" ' + kendo.attr(\"bind\") + '=\"value:' + options.field + ', invisible:isAllDay\" ' + dateTimeValidate + '/>')\n                .attr(attr)\n                .appendTo(container);\n\n            $('<input type=\"date\" required ' + kendo.attr(\"type\") + '=\"date\" ' + kendo.attr(\"bind\") + '=\"value:' + options.field + ',visible:isAllDay\" ' +\n                dateValidate + '/>')\n                .attr(attr).appendTo(container);\n\n            $('<span ' + kendo.attr(\"for\") + '=\"' + options.field + '\" class=\"k-invalid-msg\"/>').hide().appendTo(container);\n        },\n        DATERANGEEDITOR = function(container, options) {\n            var attr = { name: options.field, title: options.title },\n                isAllDay = options.model.isAllDay,\n                dateTimeValidate = kendo.attr(\"validate\") + \"='\" + (!isAllDay) + \"' \",\n                dateValidate = kendo.attr(\"validate\") + \"='\" + (!!isAllDay) + \"' \";\n\n            appendTimezoneAttr(attr, options);\n            appendValidDateValidator(attr, options);\n            appendDateCompareValidator(attr, options);\n\n            $('<input type=\"text\" required ' + kendo.attr(\"type\") + '=\"date\"' + ' ' + kendo.attr(\"role\") + '=\"datetimepicker\" ' + kendo.attr(\"bind\") + '=\"value:' + options.field + ',invisible:isAllDay\" ' +\n                dateTimeValidate + '/>')\n            .attr(attr).appendTo(container);\n\n            $('<input type=\"text\" required ' + kendo.attr(\"type\") + '=\"date\"' + ' ' + kendo.attr(\"role\") + '=\"datepicker\" ' + kendo.attr(\"bind\") + '=\"value:' + options.field + ',visible:isAllDay\" ' +\n                dateValidate + '/>')\n            .attr(attr).appendTo(container);\n\n            $('<span ' + kendo.attr(\"bind\") + '=\"text: ' + options.field + 'Timezone\"></span>').appendTo(container);\n\n            if (options.field === \"end\") {\n                $('<span ' + kendo.attr(\"bind\") + '=\"text: startTimezone, invisible: endTimezone\"></span>').appendTo(container);\n            }\n\n            $('<span ' + kendo.attr(\"for\") + '=\"' + options.field + '\" class=\"k-invalid-msg\"/>').hide().appendTo(container);\n        },\n        RECURRENCEEDITOR = function(container, options) {\n            $('<div ' + kendo.attr(\"bind\") + '=\"value:' + options.field + '\" />')\n                .attr({\n                    name: options.field\n                })\n                .appendTo(container)\n                .kendoRecurrenceEditor({\n                    start: options.model.start,\n                    timezone: options.timezone,\n                    messages: options.messages\n                });\n        },\n        MOBILERECURRENCEEDITOR = function(container, options) {\n            $('<div ' + kendo.attr(\"bind\") + '=\"value:' + options.field + '\" />')\n                .attr({\n                    name: options.field\n                })\n                .appendTo(container)\n                .kendoMobileRecurrenceEditor({\n                    start: options.model.start,\n                    timezone: options.timezone,\n                    messages: options.messages,\n                    pane: options.pane,\n                    value: options.model[options.field]\n                });\n        },\n        MOBILEISALLDAYEDITOR = function(container, options) {\n            $('<input type=\"checkbox\" data-role=\"switch\"' + kendo.attr(\"bind\") + '=\"value:' + options.field + '\" />').appendTo(container);\n        },\n        ISALLDAYEDITOR = function(container, options) {\n            $('<input type=\"checkbox\" data-role=\"checkbox\"' + kendo.attr(\"bind\") + '=\"value:' + options.field + '\" data-label=\"' + options.title + '\" />')\n                .attr({\n                    id: options.field,\n                    name: options.field,\n                    title: options.title ? options.title : options.field\n                })\n                .appendTo(container);\n        },\n        MOBILETIMEZONEPOPUP = function(container, options) {\n            var text = timezoneButtonText(options.model, options.messages.noTimezone);\n            $('<span class=\"k-timezone-label\"></span>').text(text).appendTo(container);\n            $('<span class=\"k-icon k-i-arrow-chevron-right\"></span>').appendTo(container);\n            container.closest(\"li.k-item label\").on(CLICK, options.click);\n        },\n        TIMEZONEPOPUP = function(container, options) {\n            $('<a href=\"#\" class=\"k-button k-button-md k-rounded-md k-button-solid k-button-solid-base\" data-bind=\"invisible:isAllDay\"><span class=\"k-button-text\">' + options.messages.timezoneEditorButton + '</span></a>').on(CLICK, options.click).appendTo(container);\n        },\n        MOBILETIMEZONEEDITOR = function(container, options) {\n            $('<div class=\"k-mobiletimezoneeditor\" ' + kendo.attr(\"bind\") + '=\"value:' + options.field + '\" />')\n                .attr({\n                    name: options.field\n                })\n                .appendTo(container)\n                .kendoMobileTimezoneEditor({\n                    optionLabel: options.noTimezone\n                });\n        },\n        TIMEZONEEDITOR = function(container, options) {\n            var visible = options.visible || options.visible === undefined;\n            $('<div ' + kendo.attr(\"bind\") + '=\"value:' + options.field + '\" />')\n                .attr({ name: options.field })\n                .toggle(visible)\n                .appendTo(container)\n                .kendoTimezoneEditor({\n                    optionLabel: options.noTimezone,\n                    title: options.title\n                });\n        };\n\n    function timezoneButtonText(model, message) {\n        message = message || \"\";\n\n        if (model.startTimezone) {\n            message = model.startTimezone;\n\n            if (model.endTimezone) {\n                message += \" | \" + model.endTimezone;\n            }\n        }\n\n        return message;\n    }\n\n    function appendTimezoneAttr(attrs, options) {\n        var timezone = options.timezone;\n\n        if (timezone) {\n            attrs[kendo.attr(\"timezone\")] = timezone;\n        }\n    }\n\n    function appendValidDateValidator(attrs, options) {\n        var validationRules = options.model.fields[options.field].validation;\n\n        if (validationRules) {\n            var validDateRule = validationRules.validDateValidator;\n            if (validDateRule && isPlainObject(validDateRule) && validDateRule.message) {\n                attrs[kendo.attr(\"validDate-msg\")] = validDateRule.message;\n            }\n        }\n    }\n\n    function appendDateCompareValidator(attrs, options) {\n        var validationRules = options.model.fields[options.field].validation;\n\n        if (validationRules) {\n            var dateCompareRule = validationRules.dateCompare;\n            if (dateCompareRule && isPlainObject(dateCompareRule) && dateCompareRule.message) {\n                attrs[kendo.attr(\"dateCompare-msg\")] = dateCompareRule.message;\n            }\n        }\n    }\n\n    function wrapDataAccess(originalFunction, timezone) {\n        return function(data) {\n            data = originalFunction(data);\n\n            convertData(data, \"apply\", timezone);\n\n            return data || [];\n        };\n    }\n\n    function wrapDataSerialization(originalFunction, timezone) {\n        return function(data) {\n\n            if (data) {\n                if (toString.call(data) !== \"[object Array]\" && !(data instanceof kendo.data.ObservableArray)) {\n                    data = [data];\n                }\n            }\n\n            convertData(data, \"remove\", timezone, true);\n\n            data = originalFunction(data);\n\n            return data || [];\n        };\n    }\n\n    function convertData(data, method, timezone, removeUid) {\n        var event,\n            idx,\n            length,\n            startOffset,\n            endOffset;\n\n        data = data || [];\n\n        for (idx = 0, length = data.length; idx < length; idx++) {\n            event = data[idx];\n            startOffset = event.start ? event.start.getTimezoneOffset() : null;\n            endOffset = event.start ? event.end.getTimezoneOffset() : null;\n\n            if (removeUid) {\n                if (event.startTimezone || event.endTimezone) {\n                    if (timezone) {\n                        event.start = kendo.timezone.convert(event.start, event.startTimezone || event.endTimezone, timezone);\n                        event.end = kendo.timezone.convert(event.end, event.endTimezone || event.startTimezone, timezone);\n\n                        event.start = kendo.timezone[method](event.start, timezone);\n                        event.end = kendo.timezone[method](event.end, timezone);\n                    } else {\n                        event.start = kendo.timezone[method](event.start, event.startTimezone || event.endTimezone);\n                        event.end = kendo.timezone[method](event.end, event.endTimezone || event.startTimezone);\n                    }\n\n                } else if (timezone) {\n                    event.start = kendo.timezone[method](event.start, timezone);\n                    event.end = kendo.timezone[method](event.end, timezone);\n                }\n            } else {\n                if (event.startTimezone || event.endTimezone) {\n                    event.start = kendo.timezone[method](event.start, event.startTimezone || event.endTimezone);\n                    event.end = kendo.timezone[method](event.end, event.endTimezone || event.startTimezone);\n\n                    if (timezone) {\n                        event.start = kendo.timezone.convert(event.start, event.startTimezone || event.endTimezone, timezone);\n                        event.end = kendo.timezone.convert(event.end, event.endTimezone || event.startTimezone, timezone);\n                    }\n\n                } else if (timezone) {\n                    event.start = kendo.timezone[method](event.start, timezone);\n                    event.end = kendo.timezone[method](event.end, timezone);\n                }\n            }\n\n            if (removeUid) {\n                delete event.uid;\n            }\n\n            if (method === \"remove\" && event.start && startOffset && startOffset !== event.start.getTimezoneOffset()) {\n                event.start = new Date(event.start.getTime() + (startOffset - event.start.getTimezoneOffset()) * 60000);\n            }\n            if (method === \"remove\" && event.end && endOffset && endOffset !== event.end.getTimezoneOffset()) {\n                event.end = new Date(event.end.getTime() + (endOffset - event.end.getTimezoneOffset()) * 60000);\n            }\n        }\n        return data;\n    }\n\n    function getOccurrenceByUid(data, uid) {\n        var length = data.length,\n            idx = 0,\n            event;\n\n        for (; idx < length; idx++) {\n            event = data[idx];\n\n            if (event.uid === uid) {\n                return event;\n            }\n        }\n    }\n\n    var SchedulerDataReader = kendo.Class.extend({\n        init: function(schema, reader) {\n            var timezone = schema.timezone;\n\n            this.reader = reader;\n\n            if (reader.model) {\n                this.model = reader.model;\n            }\n\n            this.timezone = timezone;\n            this.data = wrapDataAccess(this.data.bind(this), timezone);\n            this.serialize = wrapDataSerialization(this.serialize.bind(this), timezone);\n        },\n        errors: function(data) {\n            return this.reader.errors(data);\n        },\n        parse: function(data) {\n            return this.reader.parse(data);\n        },\n        data: function(data) {\n            return this.reader.data(data);\n        },\n        total: function(data) {\n            return this.reader.total(data);\n        },\n        groups: function(data) {\n            return this.reader.groups(data);\n        },\n        aggregates: function(data) {\n            return this.reader.aggregates(data);\n        },\n        serialize: function(data) {\n            return this.reader.serialize(data);\n        }\n    });\n\n    function applyZone(date, fromZone, toZone) {\n        if (toZone) {\n            date = kendo.timezone.convert(date, fromZone, toZone);\n        } else {\n            date = kendo.timezone.remove(date, fromZone);\n        }\n\n        return date;\n    }\n\n    function validDateValidator(input) {\n        if ((input.filter(\"[name=start]\").length && input.filter(\"[title=Start]\").length) ||\n            (input.filter(\"[name=end]\").length && input.filter(\"[title=End]\").length) ||\n            input.filter(\".k-recur-until\").length) {\n            var date;\n            var picker = kendo.widgetInstance(input, kendo.ui);\n\n            if (picker) {\n                date = kendo.parseDate(input.val(), picker.options.format);\n                return !!date && picker.value();\n            } else {\n                date = kendo.parseDate(input.val());\n                return !!date;\n            }\n        }\n\n        return true;\n    }\n\n    function dateCompareValidator(input) {\n        if (input.filter(\"[name=end]\").length) {\n            var container = input.closest(\".k-scheduler-edit-form\");\n            var startInput = container.find(\"[name=start]:visible\");\n            var endInput = container.find(\"[name=end]:visible\");\n\n            if (endInput[0] && startInput[0]) {\n                var start, end;\n                var startPicker = kendo.widgetInstance(startInput, kendo.ui);\n                var endPicker = kendo.widgetInstance(endInput, kendo.ui);\n\n                var editable = container.data(\"kendoEditable\");\n                var model = editable ? editable.options.model : null;\n\n                if (startPicker && endPicker) {\n                    start = startPicker.value();\n                    end = endPicker.value();\n                } else {\n                    start = kendo.parseDate(startInput.val());\n                    end = kendo.parseDate(endInput.val());\n                }\n\n                if (start && end) {\n                    if (model) {\n                        var timezone = startInput.attr(kendo.attr(\"timezone\"));\n                        var startTimezone = model.startTimezone;\n                        var endTimezone = model.endTimezone;\n\n                        startTimezone = startTimezone || endTimezone;\n                        endTimezone = endTimezone || startTimezone;\n\n                        if (startTimezone) {\n                            start = applyZone(start, startTimezone, timezone);\n                            end = applyZone(end, endTimezone, timezone);\n                        }\n                    }\n\n                    return start <= end;\n                }\n            }\n        }\n\n        return true;\n    }\n\n    function untilDateCompareValidator(input) {\n        var untilPicker, until,\n            container, startInput, start, startPicker;\n\n        if (input.filter(\".k-recur-until\").length) {\n            untilPicker = kendo.widgetInstance(input, kendo.ui);\n            until = untilPicker.value();\n            container = input.closest(\".k-scheduler-edit-form\");\n            startInput = container.find(\"[name=start]:visible\");\n\n            if (startInput[0]) {\n                startPicker = kendo.widgetInstance(startInput, kendo.ui);\n\n                if (startPicker) {\n                    start = startPicker.value();\n                } else {\n                    start = kendo.parseDate(startInput.val());\n                }\n\n                if (start && until) {\n                    return start <= until;\n                }\n            }\n        }\n\n        return true;\n    }\n\n    var SchedulerEvent = kendo.data.Model.define({\n        init: function(value) {\n            var that = this;\n\n            kendo.data.Model.fn.init.call(that, value);\n\n            that._defaultId = that.defaults[that.idField];\n        },\n\n        _time: function(field) {\n            var date = this[field];\n            var fieldTime = \"_\" + field + \"Time\";\n\n            if (this[fieldTime]) {\n                return this[fieldTime] - kendo.date.toUtcTime(kendo.date.getDate(date));\n            }\n\n            return getMilliseconds(date);\n        },\n\n        _date: function(field) {\n            var fieldTime = \"_\" + field + \"Time\";\n\n            if (this[fieldTime]) {\n                return this[fieldTime] - this._time(field);\n            }\n\n            return kendo.date.getDate(this[field]);\n        },\n\n        clone: function(options, updateUid) {\n            var uid = this.uid,\n                event = new this.constructor($.extend({}, this.toJSON(), options));\n\n            if (!updateUid) {\n                event.uid = uid;\n            }\n\n            return event;\n        },\n\n        duration: function() {\n            var end = this.end;\n            var start = this.start;\n            var offset = (end.getTimezoneOffset() - start.getTimezoneOffset()) * kendo.date.MS_PER_MINUTE;\n\n            return end - start - offset;\n        },\n\n        expand: function(start, end, zone) {\n            return recurrence ? recurrence.expand(this, start, end, zone) : [this];\n        },\n\n        update: function(eventInfo) {\n            for (var field in eventInfo) {\n                this.set(field, eventInfo[field]);\n            }\n\n            if (this._startTime) {\n                this.set(\"_startTime\", kendo.date.toUtcTime(this.start));\n            }\n\n            if (this._endTime) {\n                this.set(\"_endTime\", kendo.date.toUtcTime(this.end));\n            }\n        },\n\n        isMultiDay: function() {\n            return this.isAllDay || this.duration() >= kendo.date.MS_PER_DAY;\n        },\n\n        isException: function() {\n            return !this.isNew() && this.recurrenceId;\n        },\n\n        isOccurrence: function() {\n            return this.isNew() && this.recurrenceId;\n        },\n\n        isRecurring: function() {\n            return !!(this.recurrenceRule || this.recurrenceId);\n        },\n\n        isRecurrenceHead: function() {\n            return !!(this.id && this.recurrenceRule);\n        },\n\n        toOccurrence: function(options) {\n            options = $.extend(options, {\n                recurrenceException: null,\n                recurrenceRule: null,\n                recurrenceId: this.id || this.recurrenceId\n            });\n\n            options[this.idField] = this.defaults[this.idField];\n\n            return this.clone(options, true);\n        },\n\n        toJSON: function() {\n            var obj = kendo.data.Model.fn.toJSON.call(this);\n            obj.uid = this.uid;\n\n            delete obj._startTime;\n            delete obj._endTime;\n\n            return obj;\n        },\n\n        shouldSerialize: function(field) {\n            return kendo.data.Model.fn.shouldSerialize.call(this, field) && field !== \"_defaultId\";\n        },\n\n        set: function(key, value) {\n            var isAllDay = this.isAllDay || false;\n\n            kendo.data.Model.fn.set.call(this, key, value);\n\n            if (key == \"isAllDay\" && value != isAllDay) {\n                var start = kendo.date.getDate(this.start);\n                var end = new Date(this.end);\n                var milliseconds = kendo.date.getMilliseconds(end);\n\n                if (milliseconds === 0 && value) {\n                    milliseconds = MS_PER_DAY;\n                }\n\n                this.set(\"start\", start);\n\n                if (value === true) {\n                    kendo.date.setTime(end, -milliseconds);\n\n                    if (end < start) {\n                        end = start;\n                    }\n                } else {\n                    kendo.date.setTime(end, MS_PER_DAY - milliseconds);\n                }\n\n                this.set(\"end\", end);\n            }\n        },\n        id: \"id\",\n        fields: {\n            id: { type: \"number\" },\n            title: { defaultValue: \"\", type: \"string\" },\n            start: { type: \"date\", validation: { required: true, validDate: { value: validDateValidator } } },\n            startTimezone: { type: \"string\" },\n            end: {\n                type: \"date\",\n                validation: {\n                    required: true,\n                    validDate: { value: validDateValidator },\n                    dateCompare: { value: dateCompareValidator }\n                }\n            },\n            endTimezone: { type: \"string\" },\n            recurrenceRule: {\n                defaultValue: \"\",\n                type: \"string\",\n                validation: {\n                    validDate: { value: validDateValidator },\n                    untilDateCompare: { value: untilDateCompareValidator }\n                }\n            },\n            recurrenceException: { defaultValue: \"\", type: \"string\" },\n            isAllDay: { type: \"boolean\", defaultValue: false },\n            description: { type: \"string\" }\n        }\n    });\n\n    var SchedulerDataSource = DataSource.extend({\n        init: function(options) {\n\n            DataSource.fn.init.call(this, extend(true, {}, {\n                schema: {\n                    modelBase: SchedulerEvent,\n                    model: SchedulerEvent\n                }\n            }, options));\n\n            this.reader = new SchedulerDataReader(this.options.schema, this.reader);\n        },\n\n        expand: function(start, end) {\n            var data = this.view(),\n                filter = {},\n                endOffset;\n\n            if (start && end) {\n                endOffset = end.getTimezoneOffset();\n                end = new Date(end.getTime() + MS_PER_DAY - 1);\n\n                if (end.getTimezoneOffset() !== endOffset) {\n                    end = kendo.timezone.apply(end, endOffset);\n                }\n\n                filter = {\n                    logic: \"or\",\n                    filters: [\n                        {\n                            logic: \"and\",\n                            filters: [\n                                { field: \"start\", operator: \"gte\", value: start },\n                                { field: \"end\", operator: \"gte\", value: start },\n                                { field: \"start\", operator: \"lte\", value: end }\n                            ]\n                        },\n                        {\n                            logic: \"and\",\n                            filters: [\n                                { field: \"start\", operator: \"lte\", value: new Date(start.getTime() + MS_PER_DAY - 1) },\n                                { field: \"end\", operator: \"gte\", value: start }\n                            ]\n                        }\n                    ]\n                };\n\n                data = new kendo.data.Query(expandAll(data, start, end, this.reader.timezone)).filter(filter).toArray();\n            }\n\n            return data;\n        },\n\n        cancelChanges: function(model) {\n            if (model && model.isOccurrence()) {\n                this._removeExceptionDate(model);\n            }\n\n            DataSource.fn.cancelChanges.call(this, model);\n        },\n\n        insert: function(index, model) {\n            if (!model) {\n                return;\n            }\n\n            if (!(model instanceof SchedulerEvent)) {\n                var eventInfo = model;\n\n                model = this._createNewModel();\n                model.accept(eventInfo);\n            }\n\n            if ((!this._pushCreated && model.isRecurrenceHead()) || model.recurrenceId) {\n                model = model.recurrenceId ? model : model.toOccurrence();\n                this._addExceptionDate(model);\n            }\n\n            return DataSource.fn.insert.call(this, index, model);\n        },\n\n        pushCreate: function(items) {\n            this._pushCreated = true;\n            DataSource.fn.pushCreate.call(this, items);\n            this._pushCreated = false;\n        },\n\n        remove: function(model) {\n            if (model.isRecurrenceHead()) {\n                this._removeExceptions(model);\n            } else if (model.isRecurring()) {\n                this._addExceptionDate(model);\n            }\n\n            return DataSource.fn.remove.call(this, model);\n        },\n\n        _removeExceptions: function(model) {\n            var data = this.data().slice(0),\n                item = data.shift(),\n                id = model.id;\n\n            while (item) {\n                if (item.recurrenceId === id) {\n                    DataSource.fn.remove.call(this, item);\n                }\n\n                item = data.shift();\n            }\n\n            model.set(RECURRENCE_EXCEPTION, \"\");\n        },\n\n        _removeExceptionDate: function(model) {\n            if (model.recurrenceId) {\n                var head = this.get(model.recurrenceId);\n\n                if (head) {\n                    var start = model.defaults.start;\n                    var replaceRegExp = new RegExp(\"(\\\\\" + EXCEPTION_SEPARATOR + \"?)\" + recurrence.toExceptionString(start, this.reader.timezone));\n                    var recurrenceException = (head.recurrenceException || \"\").replace(OLD_EXCEPTION_SEPARATOR_REGEXP, EXCEPTION_SEPARATOR).replace(/\\,$/, \"\");\n\n                    if (replaceRegExp.test(recurrenceException)) {\n                        head.set(RECURRENCE_EXCEPTION, recurrenceException.replace(replaceRegExp, \"\"));\n                    } else {\n                        start = model.start;\n                        replaceRegExp = new RegExp(\"(\\\\\" + EXCEPTION_SEPARATOR + \"?)\" + recurrence.toExceptionString(start, this.reader.timezone));\n                        head.set(RECURRENCE_EXCEPTION, recurrenceException.replace(replaceRegExp, \"\"));\n                    }\n                }\n            }\n        },\n\n        _addExceptionDate: function(model) {\n            var start = model.start;\n            var zone = this.reader.timezone;\n            var head = this.get(model.recurrenceId);\n            var recurrenceException = (head.recurrenceException || \"\").replace(OLD_EXCEPTION_SEPARATOR_REGEXP, EXCEPTION_SEPARATOR).replace(/\\,$/, \"\");\n\n            if (!recurrence.isException(recurrenceException, start, zone)) {\n                var newException = recurrence.toExceptionString(start, zone);\n                model.defaults.start = start;\n                head.set(RECURRENCE_EXCEPTION, recurrenceException + (recurrenceException && newException ? EXCEPTION_SEPARATOR : \"\") + newException);\n            }\n        }\n    });\n\n    function expandAll(events, start, end, zone) {\n        var length = events.length,\n            data = [],\n            idx = 0;\n\n        for (; idx < length; idx++) {\n            data = data.concat(events[idx].expand(start, end, zone));\n        }\n\n        return data;\n    }\n\n    SchedulerDataSource.create = function(options) {\n        if (isArray(options) || options instanceof kendo.data.ObservableArray) {\n            options = { data: options };\n        }\n\n        var dataSource = options || {},\n            data = dataSource.data;\n\n        dataSource.data = data;\n\n        if (!(dataSource instanceof SchedulerDataSource) && dataSource instanceof kendo.data.DataSource) {\n            throw new Error(\"Incorrect DataSource type. Only SchedulerDataSource instances are supported\");\n        }\n\n        return dataSource instanceof SchedulerDataSource ? dataSource : new SchedulerDataSource(dataSource);\n    };\n\n    extend(true, kendo.data, {\n       SchedulerDataSource: SchedulerDataSource,\n       SchedulerDataReader: SchedulerDataReader,\n       SchedulerEvent: SchedulerEvent\n    });\n\n    var defaultCommands = {\n        update: {\n            text: \"Save\",\n            className: \"k-button-solid-primary k-scheduler-update\"\n        },\n        canceledit: {\n            text: \"Cancel\",\n            className: \"k-scheduler-cancel\"\n        },\n        destroy: {\n            text: \"Delete\",\n            imageClass: \"k-i-close\",\n            className: \"k-button-solid-primary k-scheduler-delete\",\n            iconClass: \"k-icon\"\n        }\n    };\n\n    function trimOptions(options, overrideOptions) {\n        delete options.name;\n        delete options.prefix;\n\n        delete options.remove;\n        delete options.edit;\n        delete options.add;\n        delete options.navigate;\n\n        for (var key in overrideOptions) {\n            options[key] = overrideOptions[key];\n        }\n\n        return options;\n    }\n\n    /*\n    function fieldType(field) {\n        field = field != null ? field : \"\";\n        return field.type || kendo.type(field) || \"string\";\n    }\n    */\n\n    function descriptionEditor(options) {\n        var attr = createValidationAttributes(options.model, options.field);\n\n        return function(container, model) {\n            $('<textarea name=\"description\" class=\"k-input-inner\" title=\"' + model.title + '\"/>').attr(attr)\n                .appendTo(container)\n                .wrap('<span class=\"k-input k-textarea k-input-solid k-input-md k-rounded-md\"></span>');\n        };\n    }\n\n    function createValidationAttributes(model, field) {\n        var modelField = (model.fields || model)[field];\n        var specialRules = [\"url\", \"email\", \"number\", \"date\", \"boolean\"];\n        var validation = modelField ? modelField.validation : {};\n        // var type = fieldType(modelField);\n        var datatype = kendo.attr(\"type\");\n        var inArray = $.inArray;\n        var ruleName;\n        var rule;\n\n        var attr = {};\n\n        for (ruleName in validation) {\n            rule = validation[ruleName];\n\n            if (inArray(ruleName, specialRules) >= 0) {\n                attr[datatype] = ruleName;\n            } else if (!kendo.isFunction(rule)) {\n                attr[ruleName] = isPlainObject(rule) ? (rule.value || ruleName) : rule;\n            }\n\n            attr[kendo.attr(ruleName + \"-msg\")] = rule.message;\n        }\n\n        return attr;\n    }\n\n    function filterResourceEditorData(editor, parentValue, parentValueField, valueField) {\n        var editorValue = editor.value(),\n            isMs = Array.isArray(editorValue),\n            valueArray;\n\n        if (isMs) {\n            valueArray = JSON.parse(JSON.stringify(editorValue));\n        } else {\n            valueArray = [editorValue.toString()];\n        }\n\n        editor.dataSource.data().forEach(function(item) {\n            if (item[parentValueField] === null || item[parentValueField] === undefined || item[parentValueField] == parentValue) {\n                item.set(DISABLED, false);\n            } else {\n                var currentValue = item.get(valueField);\n\n                item.set(DISABLED, true);\n\n                if (valueArray.indexOf(currentValue) >= 0 || valueArray.indexOf(currentValue.toString()) >= 0) {\n                    if (isMs) {\n                        valueArray.splice(valueArray.indexOf(currentValue), 1);\n                    } else {\n                        editor.value(null);\n                        editor.trigger(CHANGE);\n                    }\n                }\n            }\n        });\n\n        if (isMs && valueArray.length < editorValue.length) {\n            editor.value(valueArray);\n            editor.trigger(CHANGE);\n        }\n    }\n\n    function bindParentValueChangeHandler(container, currentEditor, resource, parent) {\n        var parentElement = container.closest(\".k-edit-form-container\").find(\"[data-\" + kendo.ns + \"bind='value:\" + parent + \"']\");\n        var parentWidget = parentElement.getKendoDropDownList();\n\n        if (parentWidget) {\n            parentWidget.bind(CHANGE, function(ev) {\n                var parentValue = ev.sender.value();\n\n                filterResourceEditorData(currentEditor, parentValue, resource.dataParentValueField, resource.dataValueField);\n            });\n        } else {\n            parentElement.on(CHANGE, function(ev) {\n                var parentValue = ev.target.value;\n\n                filterResourceEditorData(currentEditor, parentValue, resource.dataParentValueField, resource.dataValueField);\n            });\n        }\n    }\n\n    function filterMobileResourceEditorData(resource, currentEditor, parentSelectedValue) {\n        var options = currentEditor.find(OPTION),\n            editorValue = currentEditor.val(),\n            isMs = Array.isArray(editorValue),\n            valueArray;\n\n        if (isMs) {\n            valueArray = JSON.parse(JSON.stringify(editorValue));\n        } else {\n            valueArray = [editorValue];\n        }\n\n        resource.dataSource.view().forEach(function(item, index) {\n            var itemParentValue = kendo.getter(resource.dataParentValueField)(item);\n            var valid = itemParentValue === null || itemParentValue === undefined || itemParentValue == parentSelectedValue;\n\n            if (valid) {\n                options[index].removeAttribute(DISABLED);\n            } else {\n                options[index].setAttribute(DISABLED, DISABLED);\n\n                var currentValue = \"\" + item.get(resource.dataValueField);\n\n                if (valueArray.indexOf(currentValue) >= 0) {\n                    if (isMs) {\n                        valueArray.splice(valueArray.indexOf(currentValue), 1);\n                    } else {\n                        currentEditor.val(null);\n                        currentEditor.trigger(CHANGE);\n                    }\n                }\n            }\n        });\n\n        if (isMs && valueArray.length < editorValue.length) {\n            currentEditor.val(valueArray);\n            currentEditor.trigger(CHANGE);\n        }\n    }\n\n    function dropDownResourceEditor(resource, model, parent) {\n        var attr = createValidationAttributes(model, resource.field);\n\n        return function(container) {\n            var currentEditor;\n\n            if (parent) {\n                setTimeout(function() {\n                    filterResourceEditorData(currentEditor, model[parent], resource.dataParentValueField, resource.dataValueField);\n                    bindParentValueChangeHandler(container, currentEditor, resource, parent);\n                });\n            }\n\n            currentEditor = $(kendo.format('<select aria-labelledby=\"' + resource.field + '_label\" data-{0}bind=\"value:{1}\" title=\"' + model.title + '\">', kendo.ns, resource.field))\n                .appendTo(container)\n                .attr(attr)\n                .kendoDropDownList({\n                    dataTextField: resource.dataTextField,\n                    dataValueField: resource.dataValueField,\n                    dataSource: resource.dataSource.data(),\n                    valuePrimitive: resource.valuePrimitive,\n                    optionLabel: \"None\",\n                    template: kendo.format('<span #= data.disabled ? \"data-disabled\": \"\"#><span class=\"k-scheduler-mark\" style=\"background-color:#= data.{0}?{0}:\"none\" #\"></span>#={1}#</span>', resource.dataColorField, resource.dataTextField),\n                    select: function(e) {\n                        if (e.dataItem && e.dataItem.disabled) {\n                            e.preventDefault();\n                        }\n                    },\n                    dataBound: function(e) {\n                        var options = e.sender.list.find('li');\n\n                        options.each(function(i, el) {\n                            var element = $(el);\n\n                            if (element.find(\"[data-disabled]\").length > 0) {\n                                element.addClass(\"k-disabled\");\n                            }\n                        });\n                    }\n                }).data(\"kendoDropDownList\");\n       };\n    }\n\n    function dropDownResourceEditorMobile(resource, model, parent) {\n        var attr = createValidationAttributes(model, resource.field);\n\n        return function(container) {\n            var options = \"\";\n            var view = resource.dataSource.view();\n\n            for (var idx = 0, length = view.length; idx < length; idx++) {\n                options += kendo.format('<option value=\"{0}\">{1}</option>',\n                    kendo.getter(resource.dataValueField)(view[idx]),\n                    kendo.getter(resource.dataTextField)(view[idx])\n                );\n            }\n\n            var currentEditor = $(kendo.format('<select aria-labelledby=\"' + resource.field + '_label\" data-{0}bind=\"value:{1}\">{2}</select>',\n                kendo.ns,\n                resource.field,\n                options\n            ))\n            .appendTo(container)\n            .attr(attr);\n\n            if (parent) {\n                setTimeout(function() {\n                    var parentElement = container.closest(\".k-stretched-view\").find(\"[data-\" + kendo.ns + \"bind='value:\" + parent + \"']\");\n                    var parentSelectedValue = model[parent];\n\n                    filterMobileResourceEditorData(resource, currentEditor, parentSelectedValue);\n\n                    parentElement.on(CHANGE, function(ev) {\n                        var parentValue = ev.target.value;\n\n                        filterMobileResourceEditorData(resource, currentEditor, parentValue);\n                    });\n                });\n            }\n       };\n    }\n\n    function multiSelectResourceEditor(resource, model, parent) {\n        var attr = createValidationAttributes(model, resource.field);\n\n        return function(container) {\n            var currentEditor;\n\n            if (parent) {\n                setTimeout(function() {\n                    filterResourceEditorData(currentEditor, model[parent], resource.dataParentValueField, resource.dataValueField);\n                    bindParentValueChangeHandler(container, currentEditor, resource, parent);\n                });\n            }\n\n            currentEditor = $(kendo.format('<select aria-labelledby=\"' + resource.field + '_label\" data-{0}bind=\"value:{1}\">', kendo.ns, resource.field))\n                .appendTo(container)\n                .attr(attr)\n                .kendoMultiSelect({\n                    dataTextField: resource.dataTextField,\n                    dataValueField: resource.dataValueField,\n                    dataSource: resource.dataSource.data(),\n                    valuePrimitive: resource.valuePrimitive,\n                    itemTemplate: kendo.format('<span #= data.disabled ? \"data-disabled\": \"\" #><span class=\"k-scheduler-mark\" style=\"background-color:#= data.{0}?{0}:\"none\" #\"></span>#={1}#</span>', resource.dataColorField, resource.dataTextField),\n                    tagTemplate: kendo.format('<span class=\"k-scheduler-mark\" style=\"background-color:#= data.{0}?{0}:\"none\" #\"></span>#={1}#', resource.dataColorField, resource.dataTextField),\n                    select: function(e) {\n                        if (e.dataItem && e.dataItem.disabled) {\n                            e.preventDefault();\n                        }\n                    },\n                    dataBound: function(e) {\n                        var options = e.sender.list.find('li');\n\n                        options.each(function(i, el) {\n                            var element = $(el);\n\n                            if (element.find(\"[data-disabled]\").length > 0) {\n                                element.addClass(\"k-disabled\");\n                            }\n                        });\n                    }\n                }).data(\"kendoMultiSelect\");\n       };\n    }\n\n    function multiSelectResourceEditorMobile(resource, model, parent) {\n        var attr = createValidationAttributes(model, resource.field);\n\n        return function(container) {\n            var options = \"\";\n            var view = resource.dataSource.view();\n\n            for (var idx = 0, length = view.length; idx < length; idx++) {\n                options += kendo.format('<option value=\"{0}\">{1}</option>',\n                    kendo.getter(resource.dataValueField)(view[idx]),\n                    kendo.getter(resource.dataTextField)(view[idx])\n                );\n            }\n\n            var currentEditor = $(kendo.format('<select aria-labelledby=\"' + resource.field + '_label\" data-{0}bind=\"value:{1}\" multiple=\"multiple\">{2}</select>',\n                kendo.ns,\n                resource.field,\n                options\n            ))\n            .appendTo(container)\n            .attr(attr);\n\n            if (parent) {\n                setTimeout(function() {\n                    var parentElement = container.closest(\".k-stretched-view\").find(\"[data-\" + kendo.ns + \"bind='value:\" + parent + \"']\");\n                    var parentSelectedValue = model[parent];\n\n                    filterMobileResourceEditorData(resource, currentEditor, parentSelectedValue);\n\n                    parentElement.on(CHANGE, function(ev) {\n                        var parentValue = ev.target.value;\n\n                        filterMobileResourceEditorData(resource, currentEditor, parentValue);\n                    });\n                });\n            }\n       };\n    }\n\n    function moveEventRange(event, distance) {\n        var duration = event.end.getTime() - event.start.getTime();\n\n        var start = new Date(event.start.getTime());\n\n        kendo.date.setTime(start, distance);\n\n        var end = new Date(start.getTime());\n\n        kendo.date.setTime(end, duration, true);\n\n        return {\n            start: start,\n            end: end\n        };\n    }\n\n    var editors = {\n        mobile: {\n            dateRange: MOBILEDATERANGEEDITOR,\n            timezonePopUp: MOBILETIMEZONEPOPUP,\n            timezone: MOBILETIMEZONEEDITOR,\n            recurrence: MOBILERECURRENCEEDITOR,\n            description: descriptionEditor,\n            multipleResources: multiSelectResourceEditorMobile,\n            resources: dropDownResourceEditorMobile,\n            isAllDay: MOBILEISALLDAYEDITOR\n        },\n        desktop: {\n            dateRange: DATERANGEEDITOR,\n            timezonePopUp: TIMEZONEPOPUP,\n            timezone: TIMEZONEEDITOR,\n            recurrence: RECURRENCEEDITOR,\n            description: descriptionEditor,\n            multipleResources: multiSelectResourceEditor,\n            resources: dropDownResourceEditor,\n            isAllDay: ISALLDAYEDITOR\n        }\n    };\n\n    var Editor = kendo.Observable.extend({\n        init: function(element, options) {\n\n            kendo.Observable.fn.init.call(this);\n\n            this.element = element;\n            this.options = extend(true, {}, this.options, options);\n            this.createButton = this.options.createButton;\n\n            this.toggleDateValidationHandler = this._toggleDateValidation.bind(this);\n        },\n\n        _toggleDateValidation: function(e) {\n            if (e.field == \"isAllDay\") {\n                var container = this.container,\n                    isAllDay = this.editable.options.model.isAllDay,\n                    bindAttribute = kendo.attr(\"bind\"),\n                    element, isDateTimeInput, shouldValidate;\n                container.find(\"[\" + bindAttribute + \"*=end],[\" + bindAttribute + \"*=start]\").each(function() {\n                    element = $(this);\n                    if (valueStartEndBoundRegex.test(element.attr(bindAttribute))) {\n                        isDateTimeInput = element.is(\"[\" + kendo.attr(\"role\") + \"=datetimepicker],[type*=datetime]\");\n                        shouldValidate = isAllDay !== isDateTimeInput;\n                        element.attr(kendo.attr(\"validate\"), shouldValidate);\n                    }\n                });\n            }\n        },\n\n        fields: function(editors, model) {\n            var that = this;\n            var messages = that.options.messages;\n            var timezone = that.options.timezone;\n\n            var click = function(e) {\n                e.preventDefault();\n                that._initTimezoneEditor(model, this);\n            };\n\n            var fields = [\n                { field: \"title\", title: messages.editor.title /*, format: field.format, editor: field.editor, values: field.values*/ },\n                { field: \"start\", title: messages.editor.start, editor: editors.dateRange, timezone: timezone },\n                { field: \"end\", title: messages.editor.end, editor: editors.dateRange, timezone: timezone },\n                { field: \"isAllDay\", title: messages.editor.allDayEvent, editor: editors.isAllDay }\n            ];\n\n            var checkHierarchical = function(item) {\n                return !!item[resource.dataParentValueField];\n            };\n\n            if (kendo.timezone.windows_zones) {\n                fields.push({ field: \"timezone\", title: messages.editor.timezone, editor: editors.timezonePopUp, click: click, messages: messages.editor, model: model });\n                fields.push({ field: \"startTimezone\", title: messages.editor.startTimezone, editor: editors.timezone, noTimezone: messages.editor.noTimezone });\n                fields.push({ field: \"endTimezone\", title: messages.editor.endTimezone, editor: editors.timezone, noTimezone: messages.editor.noTimezone });\n            }\n\n            if (!model.recurrenceId) {\n                fields.push({ field: \"recurrenceRule\", title: messages.editor.repeat, editor: editors.recurrence, timezone: timezone, messages: messages.recurrenceEditor, pane: this.pane });\n            }\n\n            if (\"description\" in model) {\n                fields.push({ field: \"description\", title: messages.editor.description, editor: editors.description({ model: model, field: \"description\" }) });\n            }\n\n            for (var resourceIndex = 0; resourceIndex < this.options.resources.length; resourceIndex++) {\n                var resource = this.options.resources[resourceIndex];\n                var resourceView = resource.dataSource.view();\n                var hasParent = resourceView.some(checkHierarchical);\n                var parentResource, parent;\n\n                if (hasParent) {\n                    parentResource = this.options.resources[resourceIndex - 1];\n\n                    if (parentResource) {\n                        parent = parentResource.field;\n                    }\n                }\n\n                fields.push({\n                    field: resource.field,\n                    title: resource.title,\n                    editor: resource.multiple ? editors.multipleResources(resource, model, parent) : editors.resources(resource, model, parent)\n                });\n            }\n\n            return fields;\n        },\n\n        end: function() {\n            return this.editable.end();\n        },\n\n        _buildDesktopEditTemplate: function(model, fields, editableFields) {\n            var messages = this.options.messages;\n            var settings = extend({}, kendo.Template, this.options.templateSettings);\n            var paramName = settings.paramName;\n            var html = \"\";\n\n            html += '<div class=\"k-form\">';\n\n            for (var idx = 0, length = fields.length; idx < length; idx++) {\n                var field = fields[idx];\n\n                if (field.field === \"startTimezone\") {\n                    html += '<div class=\"k-popup-edit-form k-scheduler-edit-form k-scheduler-timezones\" style=\"display:none\">';\n                    html += '<div class=\"k-form\">';\n                    html += '<div class=\"k-form-field\"><div class=\"k-form-field-wrap\">' + kendo.html.renderCheckBox($('<input class=\"k-timezone-toggle\"/>'), { label: messages.editor.separateTimezones }) + '</div></div>';\n                }\n\n                if (model.fields[field.field] && model.fields[field.field].type === \"boolean\") {\n                    html += '<div class=\"k-form-field\">';\n                } else {\n                    html += '<div class=\"k-form-field\"><label class=\"k-label k-form-label\" for=\"' + field.field + '\" id=\"' + field.field + '_label\">' + (field.title || field.field || \"\") + '</label>';\n                }\n\n                if ((!model.editable || model.editable(field.field))) {\n                    editableFields.push(field);\n                    html += '<div ' + kendo.attr(\"container-for\") + '=\"' + field.field + '\" class=\"k-form-field-wrap\"></div>';\n                } else {\n                    var tmpl = \"#:\";\n\n                    if (field.field) {\n                        field = kendo.expr(field.field, paramName);\n                        tmpl += field + \"==null?'':\" + field;\n                    } else {\n                        tmpl += \"''\";\n                    }\n\n                    tmpl += \"#\";\n\n                    tmpl = kendo.template(tmpl, settings);\n\n                    html += '<div class=\"k-form-field-wrap\">' + tmpl(model) + '</div>';\n                }\n\n                html += \"</div>\";\n\n                if (field.field === \"endTimezone\") {\n                    html += this._createEndTimezoneButton();\n                }\n            }\n\n            html += '</div>';\n\n            return html;\n        },\n\n        _buildMobileEditTemplate: function(model, fields, editableFields) {\n            var messages = this.options.messages;\n            var settings = extend({}, kendo.Template, this.options.templateSettings);\n            var paramName = settings.paramName;\n            var html = \"\";\n\n            html += '<ul class=\"k-listgroup k-listgroup-flush\">';\n\n            for (var idx = 0, length = fields.length; idx < length; idx++) {\n                var field = fields[idx];\n\n                if (field.field === \"timezone\" || field.field === \"recurrenceRule\") {\n                    html += '</ul><ul class=\"k-listgroup k-listgroup-flush\">';\n                }\n\n                if (field.field === \"startTimezone\") {\n                    html += '<div class=\"k-popup-edit-form k-scheduler-edit-form k-scheduler-timezones\" style=\"display:none\">';\n                    html += '<ul class=\"k-listgroup k-listgroup-flush\">';\n                    html += '<li class=\"k-item k-listgroup-item\">';\n                    html += '<label class=\"k-label k-listgroup-form-row\">';\n                    html += '<span class=\"k-item-title k-listgroup-form-row\">' + messages.editor.separateTimezones + '</span>';\n                    html += '<span class=\"k-listgroup-form-field-wrapper\">';\n                    html += '<input class=\"k-timezone-toggle\" data-role=\"switch\" type=\"checkbox\" />';\n                    html += '</span>';\n                    html += '</label>';\n                    html += '</li>';\n                }\n\n                if ((!model.editable || model.editable(field.field))) {\n                    html += '<li class=\"k-item k-listgroup-item\">';\n                    if (field.field === \"timezone\") {\n                        html += '<label class=\"k-label k-listgroup-form-row\" data-bind=\"css: { k-disabled: isAllDay }\">';\n                    } else {\n                        html += '<label class=\"k-label k-listgroup-form-row\">';\n                    }\n                    html += '<span class=\"k-item-title k-listgroup-form-field-label\">' + (field.title || field.field || \"\") + '</span>';\n\n                    editableFields.push(field);\n                    html += '<div class=\"k-listgroup-form-field-wrapper\" ' + kendo.attr(\"container-for\") + '=\"' + field.field + '\"></div>';\n\n                    html += '</label></li>';\n                } else {\n                    var tmpl = \"#:\";\n\n                    html += '<li class=\"k-item k-listgroup-item\">';\n                    html += '<label class=\"k-label k-no-click k-listgroup-form-row\">';\n                    html += '<span class=\"k-item-title k-listgroup-form-field-label\">' + (field.title || field.field || \"\") + '</span>';\n\n                    if (field.field) {\n                        field = kendo.expr(field.field, paramName);\n                        tmpl += field + \"==null?'':\" + field;\n                    } else {\n                        tmpl += \"''\";\n                    }\n\n                    tmpl += \"#\";\n\n                    tmpl = kendo.template(tmpl, settings);\n\n                    html += '<span class=\"k-no-editor k-listgroup-form-field-wrapper\">' + tmpl(model) + '</span>';\n\n                    html += '</label></li>';\n                }\n\n                if (field.field === \"recurrenceRule\") {\n                    html += '</ul><ul class=\"k-listgroup k-listgroup-flush\">';\n                }\n\n                if (field.field === \"endTimezone\") {\n                    html += \"</ul></div>\";\n                }\n            }\n            html += '</ul>';\n\n            return html;\n        },\n\n        _buildEditTemplate: function(model, fields, editableFields, isMobile) {\n            var settings = extend({}, kendo.Template, this.options.templateSettings);\n            var template = this.options.editable.template;\n            var html = \"\";\n\n            if (template) {\n                if (typeof template === STRING) {\n                    template = kendo.unescape(template);\n                }\n                html += (kendo.template(template, settings))(model);\n            } else if (isMobile) {\n                html += '<div data-role=\"content\">' + this._buildMobileEditTemplate(model, fields, editableFields) + '</div>';\n            } else {\n                html += this._buildDesktopEditTemplate(model, fields, editableFields);\n            }\n\n            return html;\n        },\n\n        _createEndTimezoneButton: function() {\n            return '</ul></div>';\n        },\n\n        _revertTimezones: function(model) {\n            model.set(\"startTimezone\", this._startTimezone);\n            model.set(\"endTimezone\", this._endTimezone);\n\n            delete this._startTimezone;\n            delete this._endTimezone;\n        }\n    });\n\n    var MobileEditor = Editor.extend({\n        init: function() {\n            Editor.fn.init.apply(this, arguments);\n\n            this.pane = kendo.Pane.wrap(this.element, {\n                viewEngine: {\n                    viewOptions: {\n                        renderOnInit: true,\n                        wrap: false,\n                        wrapInSections: true,\n                        detachOnHide: false,\n                        detachOnDestroy: false\n                    }\n                }\n            });\n            this.pane.element.parent().css(\"height\", this.options.height);\n            this.view = this.pane.view();\n        },\n\n        options: {\n            animations: {\n                left: \"slide\",\n                right: \"slide:right\"\n            }\n        },\n\n        destroy: function() {\n            this.close();\n            this.unbind();\n            this.pane.destroy();\n        },\n\n        _initTimezoneEditor: function(model) {\n            var that = this;\n            var pane = that.pane;\n            var messages = that.options.messages;\n            var timezoneView = that.timezoneView;\n            var container = timezoneView ? timezoneView.content.find(\".k-scheduler-timezones\") : that.container.find(\".k-scheduler-timezones\");\n            var kSwitch = container.find(\"input.k-timezone-toggle\").data(\"kendoSwitch\");\n            var endTimezoneRow = container.find(\"li.k-item:not(.k-zonepicker)\").last();\n            var startTimezoneChange = function(e) {\n                if (e.field === \"startTimezone\") {\n                    var value = model.startTimezone;\n\n                    kSwitch.enable(value);\n\n                    if (!value) {\n                        endTimezoneRow.hide();\n                        model.set(\"endTimezone\", \"\");\n                        kSwitch.value(false);\n                    }\n                }\n            };\n\n            that._startTimezone = model.startTimezone || \"\";\n            that._endTimezone = model.endTimezone || \"\";\n\n            if (!timezoneView) {\n                var html = '<div data-role=\"view\" class=\"k-popup-edit-form k-scheduler-edit-form\">' +\n                '<div data-role=\"header\" class=\"k-header\">' +\n                    '<a href=\"\\\\#\" class=\"k-header-cancel k-scheduler-cancel k-link\" title=\"' + messages.cancel + '\"' +\n                    'aria-label=\"' + messages.cancel + '\"><span class=\"k-icon k-i-arrow-chevron-left\"></span></a>' +\n                    messages.editor.timezoneTitle +\n                    '<a href=\"\\\\#\" class=\"k-header-done k-scheduler-update k-link\" title=\"' + messages.save + '\" ' +\n                    'aria-label=\"' + messages.save + '\"><span class=\"k-icon k-i-check\"></span></a>' +\n                '</div><div data-role=\"content\"></div>';\n\n                this.timezoneView = timezoneView = pane.append(html);\n\n                timezoneView.contentElement.append(container.show());\n\n                timezoneView.element.on(CLICK + NS, \".k-scheduler-cancel, .k-scheduler-update\", function(e) {\n                    e.preventDefault();\n                    e.stopPropagation();\n\n                    if ($(this).hasClass(\"k-scheduler-cancel\")) {\n                        that._revertTimezones(model);\n                    }\n\n                    var editView = that._editPane;\n\n                    var text = timezoneButtonText(model, messages.editor.noTimezone);\n\n                    editView.content.find(\".k-timezone-label\").text(text);\n\n                    pane.navigate(editView, that.options.animations.right);\n                });\n\n                kSwitch.bind(CHANGE, function(ev) {\n                    endTimezoneRow.toggle(ev.checked);\n                    model.set(\"endTimezone\", \"\");\n                });\n                model.bind(CHANGE, startTimezoneChange);\n            }\n\n            kSwitch.value(!!model.endTimezone);\n            kSwitch.enable(!!model.startTimezone);\n\n            if (model.endTimezone) {\n                endTimezoneRow.show();\n            } else {\n                endTimezoneRow.hide();\n            }\n\n            pane.navigate(timezoneView, that.options.animations.left);\n        },\n\n        showDialog: function(options) {\n            var actions = options.buttons.map(function(button) {\n                return {\n                    text: button.text,\n                    action: button.click\n                };\n            });\n\n            actions.push({\n                text: this.options.messages.cancel,\n                primary: true\n            });\n\n            $(\"<div />\").appendTo(document.body)\n                .kendoDialog({\n                    close: function() {\n                        this.destroy();\n                    },\n                    modal: {\n                        preventScroll: true\n                    },\n                    closable: false,\n                    title: false,\n                    content: options.text,\n                    actions: actions\n                });\n        },\n\n        editEvent: function(model) {\n            var pane = this.pane;\n            var html = \"\";\n\n            var messages = this.options.messages;\n            var updateText = messages.save;\n            var removeText = messages.destroy;\n            var cancelText = messages.cancel;\n            var titleText = messages.editor.editorTitle;\n            var resetSeries = messages.resetSeries;\n\n            html += '<div data-role=\"view\" class=\"k-popup-edit-form k-scheduler-edit-form\"' + kendo.attr(\"uid\") + '=\"' + model.uid + '\">' +\n                '<div data-role=\"header\" class=\"k-header\">' +\n                    '<a href=\"\\\\#\" class=\"k-header-cancel k-scheduler-cancel k-link\" title=\"' + cancelText + '\"' +\n                    'aria-label=\"' + cancelText + '\"><span class=\"k-icon k-i-arrow-chevron-left\"></span></a>' +\n                    titleText +\n                    '<a href=\"\\\\#\" class=\"k-header-done k-scheduler-update k-link\" title=\"' + updateText + '\" ' +\n                    'aria-label=\"' + updateText + '\"><span class=\"k-icon k-i-check\"></span></a>' +\n                '</div>';\n\n            var fields = this.fields(editors.mobile, model);\n\n            var that = this;\n\n            var editableFields = [];\n\n            html += this._buildEditTemplate(model, fields, editableFields, true);\n\n            html += \"</div>\";\n\n            var view = pane.append(html);\n\n            if (!model.isNew() && this.options.editable && this.options.editable.destroy !== false && model.isRecurrenceHead() && model.recurrenceException) {\n                var resetSeriesBtn = '<ul class=\"k-edit-buttons k-listgroup k-listgroup-flush\"><li class=\"k-item k-listgroup-item\"><span class=\"k-scheduler-resetSeries k-link k-label\" aria-label=\"' + resetSeries + '\">' + resetSeries + '</span></li></ul>';\n                view.contentElement.append(resetSeriesBtn);\n            }\n\n            if (!model.isNew() && this.options.editable && this.options.editable.destroy !== false) {\n                var deleteBtn = '<ul class=\"k-edit-buttons k-listgroup k-listgroup-flush\"><li class=\"k-item k-listgroup-item\"><span class=\"k-scheduler-delete k-link k-label\" aria-label=\"' + removeText + '\">' + removeText + '</span></li></ul>';\n                view.contentElement.append(deleteBtn);\n            }\n\n            this._editPane = view;\n\n            var container = this.container = view.element;\n\n            this.editable = container.kendoEditable({\n                fields: editableFields,\n                model: model,\n                clearContainer: false,\n                target: that.options.target,\n                validateOnBlur: true\n            }).data(\"kendoEditable\");\n\n            if (!this.trigger(\"edit\", { container: container, model: model })) {\n\n                container.on(CLICK + NS, \"a.k-scheduler-edit, a.k-scheduler-cancel, a.k-scheduler-update, span.k-scheduler-delete, span.k-scheduler-resetSeries\", function(e) {\n                    e.preventDefault();\n                    e.stopPropagation();\n\n                    var button = $(this);\n\n                    if (!button.hasClass(\"k-scheduler-edit\")) {\n\n                        var name = \"cancel\";\n\n                        if (button.hasClass(\"k-scheduler-update\")) {\n                            name = \"save\";\n                        } else if (button.hasClass(\"k-scheduler-delete\")) {\n                            name = \"remove\";\n                        } else if (button.hasClass(\"k-scheduler-resetSeries\")) {\n                            name = RESET;\n                        }\n\n                        that.trigger(name, { container: container, model: model });\n                    } else {\n                        pane.navigate(this._editPane, that.options.animations.right);\n                    }\n                });\n\n                pane.navigate(view, that.options.animations.left);\n\n                model.bind(CHANGE, that.toggleDateValidationHandler);\n            } else {\n                this.trigger(\"cancel\", { container: container, model: model });\n            }\n\n            return this.editable;\n        },\n\n        _views: function() {\n            return this.pane.element\n                    .find(kendo.roleSelector(\"view\"))\n                    .not(this.view.element);\n        },\n\n        close: function() {\n            if (this.container) {\n                this.pane.navigate(\"\", this.options.animations.right);\n\n                var views = this._views();\n                var view;\n\n                for (var idx = 0, length = views.length; idx < length; idx++) {\n                    view = views.eq(idx).data(\"kendoView\");\n                    if (view) {\n                       view.purge();\n                    }\n                }\n\n                views.remove();\n\n                this.container = null;\n                if (this.editable) {\n                    this.editable.options.model.unbind(CHANGE, this.toggleDateValidationHandler);\n                    this.editable.destroy();\n                    this.editable = null;\n                }\n                this.timezoneView = null;\n            }\n        }\n    });\n\n    var PopupEditor = Editor.extend({\n        destroy: function() {\n            this.close();\n            this.unbind();\n        },\n\n        editEvent: function(model) {\n            var that = this;\n            var editable = that.options.editable;\n            var html = '<div ' + kendo.attr(\"uid\") + '=\"' + model.uid + '\" class=\"k-popup-edit-form k-scheduler-edit-form\"><div class=\"k-edit-form-container\">';\n            var messages = that.options.messages;\n            var updateText = messages.save;\n            var cancelText = messages.cancel;\n            var deleteText = messages.destroy;\n            var resetSeries = messages.resetSeries;\n            var fields = this.fields(editors.desktop, model);\n            var editableFields = [];\n            var fieldName;\n\n            html += this._buildEditTemplate(model, fields, editableFields, false);\n\n            var attr;\n            var options = isPlainObject(editable) ? editable.window : {};\n\n            html += '<div class=\"k-edit-buttons\">';\n            html += this.createButton({ name: \"update\", text: updateText, attr: attr }) + this.createButton({ name: \"canceledit\", text: cancelText, attr: attr });\n\n            if (!model.isNew() && editable.destroy !== false && model.isRecurrenceHead() && model.recurrenceException) {\n                html += this.createButton({ name: \"resetSeries\", text: resetSeries, attr: attr });\n            }\n\n            if ((!model.isNew() || model.isRecurring()) && editable.destroy !== false) {\n                html += this.createButton({ name: \"delete\", text: deleteText, attr: attr });\n            }\n\n            html += '</div></div></div>';\n\n            var container = this.container = $(html)\n                .appendTo(that.element).eq(0)\n                .kendoWindow(extend({\n                    modal: true,\n                    resizable: false,\n                    draggable: true,\n                    title: messages.editor.editorTitle,\n                    visible: false,\n                    close: function(e) {\n                        if (e.userTriggered) {\n                            if (that.trigger(CANCEL, { container: container, model: model })) {\n                                e.preventDefault();\n                            }\n                        }\n                    }\n                }, options));\n\n            that.editable = container.kendoEditable({\n                fields: editableFields,\n                model: model,\n                clearContainer: false,\n                validateOnBlur: true,\n                target: that.options.target\n            }).data(\"kendoEditable\");\n\n            for (var field in editableFields) {\n                if (editableFields[field].field !== \"recurrenceRule\") {\n                    fieldName = editableFields[field].field;\n                    container.find(\"[name='\" + fieldName + \"']\").attr(\"aria-labelledby\", fieldName + \"_label\");\n                }\n\n                if (editableFields[field].field === \"isAllDay\") {\n                    container.find(\"label[for='\" + fieldName + \"']\").attr(\"id\", fieldName + \"_label\");\n                }\n            }\n\n            if (!that.trigger(EDIT, { container: container, model: model })) {\n\n                container.data(\"kendoWindow\").center().open();\n\n                container.on(CLICK + NS, \"button.k-scheduler-cancel\", function(e) {\n                    e.preventDefault();\n                    e.stopPropagation();\n\n                    that.trigger(CANCEL, { container: container, model: model });\n                });\n\n                container.on(CLICK + NS, \"button.k-scheduler-update\", function(e) {\n                    e.preventDefault();\n                    e.stopPropagation();\n\n                    that.trigger(\"save\", { container: container, model: model });\n                });\n\n                container.on(CLICK + NS, \"button.k-scheduler-delete\", function(e) {\n                    e.preventDefault();\n                    e.stopPropagation();\n\n                    that.trigger(REMOVE, { container: container, model: model });\n                });\n\n                container.on(CLICK + NS, \"button.k-scheduler-resetSeries\", function(e) {\n                    e.preventDefault();\n                    e.stopPropagation();\n                    that.trigger(RESET, { container: container, model: model });\n                });\n\n                kendo.cycleForm(container);\n\n                model.bind(CHANGE, that.toggleDateValidationHandler);\n            } else {\n                that.trigger(CANCEL, { container: container, model: model });\n            }\n\n            return that.editable;\n        },\n\n        close: function() {\n            var that = this;\n\n            var destroy = function() {\n                if (that.editable) {\n                    that.editable.options.model.unbind(CHANGE, that.toggleDateValidationHandler);\n                    that.editable.destroy();\n                    that.editable = null;\n                    that.container = null;\n                }\n                if (that.popup) {\n                    that.popup.destroy();\n                    that.popup = null;\n                }\n            };\n\n            if (that.editable) {\n                if (that._timezonePopup && that._timezonePopup.data(\"kendoWindow\")) {\n                    that._timezonePopup.data(\"kendoWindow\").destroy();\n                    that._timezonePopup = null;\n                }\n\n                if (that.container.is(\":visible\")) {\n                    that.container.data(\"kendoWindow\").bind(\"deactivate\", destroy).close();\n                } else {\n                    destroy();\n                }\n            } else {\n                destroy();\n            }\n        },\n\n        _createEndTimezoneButton: function() {\n            var messages = this.options.messages;\n            var html = \"\";\n\n            html += '<div class=\"k-edit-buttons\">';\n            html += this.createButton({ name: \"savetimezone\", text: messages.save }) + this.createButton({ name: \"canceltimezone\", text: messages.cancel });\n            html += '</div></div></div>';\n\n            return html;\n        },\n\n        showDialog: function(options) {\n            var html = kendo.format(\"<div class='k-popup-edit-form'><div class='k-edit-form-container'><p class='k-popup-message'>{0}</p>\", options.text);\n\n            html += '<div class=\"k-edit-buttons\">';\n\n            for (var buttonIndex = 0; buttonIndex < options.buttons.length; buttonIndex++) {\n                html += this.createButton(options.buttons[buttonIndex]);\n            }\n\n            html += '</div></div></div>';\n\n            var wrapper = this.element;\n\n            if (this.popup) {\n                this.popup.destroy();\n            }\n\n            var popup = this.popup = $(html).appendTo(wrapper)\n                               .eq(0)\n                               .on(CLICK, \".k-button\", function(e) {\n                                    e.preventDefault();\n\n                                    popup.close();\n\n                                    var buttonIndex = $(e.currentTarget).index();\n\n                                    options.buttons[buttonIndex].click();\n                               })\n                               .kendoWindow({\n                                   modal: true,\n                                   resizable: false,\n                                   draggable: false,\n                                   title: options.title,\n                                   visible: false,\n                                   close: function() {\n                                       this.destroy();\n                                       wrapper.trigger(\"focus\");\n                                   }\n                               })\n                               .getKendoWindow();\n\n            popup.center().open();\n        },\n\n        _initTimezoneEditor: function(model, activator) {\n            var that = this;\n            var container = that.container.find(\".k-scheduler-timezones\");\n            var checkbox = container.find(\"input.k-timezone-toggle\");\n            var endTimezoneRow = container.find(\".k-form-field\").last();\n            var saveButton = container.find(\".k-scheduler-savetimezone\");\n            var cancelButton = container.find(\".k-scheduler-canceltimezone\");\n            var timezonePopup = that._timezonePopup;\n            var startTimezoneChange = function(e) {\n                if (e.field === \"startTimezone\") {\n                    var value = model.startTimezone;\n\n                    checkbox.prop(DISABLED, !value);\n\n                    if (!value) {\n                        endTimezoneRow.hide();\n                        model.set(\"endTimezone\", \"\");\n                        checkbox.prop(\"checked\", false);\n                    }\n                }\n            };\n            var wnd;\n\n            that._startTimezone = model.startTimezone;\n            that._endTimezone = model.endTimezone;\n\n            if (!timezonePopup) {\n                that._timezonePopup = timezonePopup = container.kendoWindow({\n                    modal: true,\n                    resizable: false,\n                    draggable: true,\n                    title: that.options.messages.editor.timezoneEditorTitle,\n                    visible: false,\n                    close: function(e) {\n                        model.unbind(CHANGE, startTimezoneChange);\n\n                        if (e.userTriggered) {\n                            that._revertTimezones(model);\n                        }\n\n                        if (activator) {\n                            activator.focus();\n                        }\n                    }\n                });\n\n                checkbox.on(CLICK, function() {\n                    endTimezoneRow.toggle(checkbox.prop(\"checked\"));\n                    model.set(\"endTimezone\", \"\");\n                });\n\n                saveButton.on(CLICK, function(e) {\n                    e.preventDefault();\n                    wnd.close();\n                });\n\n                cancelButton.on(CLICK, function(e) {\n                    e.preventDefault();\n                    that._revertTimezones(model);\n                    wnd.close();\n                });\n\n                model.bind(CHANGE, startTimezoneChange);\n            }\n\n            checkbox.prop(\"checked\", model.endTimezone).prop(DISABLED, !model.startTimezone);\n\n            if (model.endTimezone) {\n                endTimezoneRow.show();\n            } else {\n                endTimezoneRow.hide();\n            }\n\n            wnd = timezonePopup.data(\"kendoWindow\");\n            wnd.center().open();\n        }\n    });\n\n    var Scheduler = DataBoundWidget.extend({\n        init: function(element, options) {\n            var that = this;\n\n            Widget.fn.init.call(that, element, options);\n\n            if (!that.options.views || !that.options.views.length) {\n                that.options.views = [\"day\", \"week\"];\n            }\n\n            that.resources = [];\n\n            that._initModel();\n\n            that._wrapper();\n\n            that._views();\n\n            that._toolbar();\n\n            that._dataSource();\n\n            that._resources();\n\n            that._resizeHandler = function() {\n                that.resize();\n            };\n\n            that.wrapper.on(MOUSEDOWN + NS + \" selectstart\" + NS, function(e) {\n                if (!$(e.target).is(\":kendoFocusable\")) {\n                    e.preventDefault();\n                }\n            });\n\n            if (that.options.editable && that.options.editable.resize !== false) {\n                that._resizable();\n            }\n\n            that._movable();\n\n            that._bindResize();\n\n            if (that.options.messages && that.options.messages.recurrence) {\n                recurrence.options = that.options.messages.recurrence;\n            }\n\n            if (that.options.selectable) {\n                that._tabindex();\n            }\n\n            that._navigation();\n            that._selectable();\n            that._touchHandlers();\n\n            that._ariaId = kendo.guid();\n\n            that._createEditor();\n        },\n\n        _bindResize: function() {\n            $(window).on(\"resize\" + NS, this._resizeHandler);\n        },\n\n        _unbindResize: function() {\n            $(window).off(\"resize\" + NS, this._resizeHandler);\n        },\n\n        dataItems: function() {\n            var that = this;\n            var items = that.items();\n            var events = that._data;\n            var eventsUids = $.map(items, function(item) {\n                return $(item).attr(\"data-uid\");\n            });\n            var i;\n            var key;\n\n            var dict = {};\n            var eventsUidsLength = eventsUids.length;\n            for (i = 0; i < eventsUidsLength; i++) {\n                dict[eventsUids[i]] = null;\n            }\n\n            var eventsCount = events.length;\n            for (i = 0; i < eventsCount; i++) {\n                var event = events[i];\n                if (dict[event.uid] !== undefined) {\n                    dict[event.uid] = event;\n                }\n            }\n\n            var sortedData = [];\n            for (key in dict) {\n                sortedData.push(dict[key]);\n            }\n\n            return sortedData;\n        },\n\n        _isMobile: function() {\n            var options = this.options;\n            return (options.mobile === true && kendo.support.mobileOS) || options.mobile === \"phone\" || options.mobile === \"tablet\";\n        },\n\n        _isTouch: function(event) {\n            return /touch/.test(event.type) || (event.originalEvent && /touch/.test(event.originalEvent.pointerType));\n        },\n\n        _isInverseColor: function(eventElement) {\n            return eventElement.hasClass(INVERSECOLORCLASS);\n        },\n\n        _groupsByResource: function(resources, groupIndex, groupsArray, parentFieldValue, parentField) {\n            if (!groupsArray) {\n                groupsArray = [];\n            }\n\n            var resource = resources[0];\n            if (resource) {\n                var group;\n                var data = resource.dataSource.view();\n                var prevIndex = 0;\n\n                for (var dataIndex = 0; dataIndex < data.length; dataIndex++) {\n                    var fieldValue = kendo.getter(resource.dataValueField)(data[dataIndex]);\n                    var currentGroupIndex = groupIndex + prevIndex + dataIndex;\n\n                    group = this._groupsByResource(resources.slice(1), currentGroupIndex, groupsArray, fieldValue, resource.field);\n                    group[resource.field] = fieldValue;\n                    prevIndex = group.groupIndex;\n\n                    if (parentField && parentFieldValue) {\n                        group[parentField] = parentFieldValue;\n                    }\n\n                    if (resources.length === 1) {\n                        group.groupIndex = groupIndex + dataIndex;\n                        groupsArray.push(group);\n                    }\n                }\n                return group;\n            } else {\n                return {};\n            }\n        },\n\n        data: function() {\n            return this._data;\n        },\n\n        select: function(options) {\n            var that = this;\n            var view = that.view();\n            var selection = that._selection;\n            var groups = view.groups;\n            var selectedGroups;\n\n            if (options === undefined) {\n                var selectedEvents;\n                var slots = view._selectedSlots;\n\n                if (!selection) {\n                    return [];\n                }\n\n                if (selection && selection.events) {\n                    selectedEvents = that._selectedEvents();\n                }\n\n                return {\n                    start: selection.start,\n                    end: selection.end,\n                    events: selectedEvents,\n                    slots: slots,\n                    resources: view._resourceBySlot(selection)\n                };\n            }\n\n            if (!options) {\n                that._selection = null;\n                that._old = null;\n                view.clearSelection();\n\n                return;\n            }\n\n            if (Array.isArray(options)) {\n                options = {\n                    events: options.splice(0)\n                };\n            }\n\n            if (options.resources) {\n                var fieldName;\n                var filters = [];\n                var groupsByResource = [];\n\n                if (view.groupedResources) {\n                    that._groupsByResource(view.groupedResources, 0, groupsByResource);\n                }\n\n                for (fieldName in options.resources) {\n                    filters.push({ field: fieldName, operator: \"eq\", value: options.resources[fieldName] });\n                }\n\n                selectedGroups = new kendo.data.Query(groupsByResource)\n                    .filter(filters)\n                    .toArray();\n            }\n\n            if (options.events && options.events.length) {\n                that._selectEvents(options.events, selectedGroups);\n                that._select();\n\n                return;\n            }\n\n            if (groups && (options.start && options.end)) {\n                var rangeStart = getDate(view._startDate);\n                var rangeEnd = kendo.date.addDays(getDate(view._endDate),1);\n                var group;\n                var ranges;\n\n                if (options.start < rangeEnd && rangeStart <= options.end) {\n                    if (selectedGroups && selectedGroups.length) {\n                        group = groups[selectedGroups[0].groupIndex];\n                    } else {\n                        group = groups[0];\n                    }\n\n                    if (!group.timeSlotCollectionCount()) {\n                        options.isAllDay = true;\n                    }\n\n                    ranges = group.ranges(options.start, options.end, options.isAllDay, false);\n\n                    if (ranges.length) {\n                        that._selection = {\n                            start: kendo.timezone.toLocalDate(ranges[0].start.start),\n                            end: kendo.timezone.toLocalDate(ranges[ranges.length - 1].end.end),\n                            groupIndex: ranges[0].start.groupIndex,\n                            index: ranges[0].start.index,\n                            isAllDay: ranges[0].start.isDaySlot,\n                            events: []\n                        };\n\n                        that._select();\n                    }\n                }\n            }\n        },\n\n        _selectEvents: function(eventsUids, selectedGroups) {\n            var that = this;\n            var idx;\n            var view = that.view();\n            var groups = view.groups;\n            var eventsLength = eventsUids.length;\n            var isGrouped = selectedGroups && selectedGroups.length;\n            var ctrlKey = that._ctrlKey;\n\n            that._ctrlKey = true;\n\n            for (idx = 0; idx < eventsLength; idx++) {\n                if (groups && isGrouped) {\n                    var currentGroup = groups[selectedGroups[0].groupIndex];\n                    var events = [];\n                    var timeSlotCollectionCount = currentGroup.timeSlotCollectionCount();\n                    var daySlotCollectionCount = currentGroup.daySlotCollectionCount();\n\n                    for (var collIdx = 0; collIdx < timeSlotCollectionCount; collIdx++) {\n                        events = events.concat(currentGroup.getTimeSlotCollection(collIdx).events());\n                    }\n\n                    for (var dayCollIdx = 0; dayCollIdx < daySlotCollectionCount; dayCollIdx++) {\n                        events = events.concat(currentGroup.getDaySlotCollection(dayCollIdx).events());\n                    }\n\n                    events = new kendo.data.Query(events)\n                        .filter({ field: \"element[0].getAttribute('data-uid')\", operator: \"eq\", value: eventsUids[idx] })\n                        .toArray();\n\n                    if (events[0]) {\n                        that._createSelection(events[0].element);\n                    }\n                } else {\n                    var element = view.element.find(kendo.format(\".k-event[data-uid={0}], .k-task[data-uid={0}]\", eventsUids[idx]));\n\n                    if (element.length) {\n                        that._createSelection(element[0]);\n                    }\n                }\n            }\n\n            that._ctrlKey = ctrlKey;\n        },\n\n        _touchHandlers: function() {\n            var that = this;\n            var startX;\n            var startY;\n            var endX;\n            var endY;\n            var timeStamp;\n            var wrapper = that.wrapper;\n            var touchMoveHandler = that._touchMove.bind(that);\n\n            wrapper.on(TOUCHSTART + NS, \".k-scheduler-header-all-day td, .k-scheduler-content td, .k-event\", function(e) {\n                var content = that.wrapper.find(\".k-scheduler-content\");\n\n                if (!that._isTouch(e)) {\n                    return;\n                }\n\n                content.stop(true, false);\n\n                that._touchPosX = startX = that._tapPosition(e, 'X');\n                that._touchPosY = startY = that._tapPosition(e, 'Y');\n                that._userTouched = true;\n                that.view()._scrolling = false;\n                timeStamp = Date.now();\n\n                wrapper.on(TOUCHMOVE + NS, \".k-scheduler-header-all-day td, .k-scheduler-content td, .k-event\", touchMoveHandler);\n            });\n\n            wrapper.on(\"contextmenu\" + NS, \".k-scheduler-header-all-day td, .k-scheduler-content td, .k-event\", function(e) {\n                that._preventFocus = true;\n            });\n\n            wrapper.on(TOUCHEND + NS, \".k-scheduler-header-all-day td, .k-scheduler-content td, .k-event\", function(e) {\n                if (!that._isTouch(e)) {\n                    return;\n                }\n\n                var delta = Date.now() - timeStamp;\n                var content = that.wrapper.find(\".k-scheduler-content\");\n                var amplitude = -that._amplitude * (3000 / delta);\n\n                endX = that._tapPosition(e, 'X');\n                endY = that._tapPosition(e, 'Y');\n\n                if (that._dragging) {\n                    return;\n                }\n\n                if (that.options.selectable && (Math.abs(endX - startX) <= 10 || Math.abs(endY - startY) <= 10)) {\n                    that._mouseDownSelection(e);\n                }\n\n                if (!kendo.support.kineticScrollNeeded && delta < 200 && Math.abs(endX - startX) > 10) {\n                    content.animate({\n                        scrollTop: content[0].scrollTop + amplitude\n                    });\n                }\n\n                wrapper.off(TOUCHMOVE + NS, \".k-scheduler-header-all-day td, .k-scheduler-content td\", touchMoveHandler);\n            });\n        },\n\n        _navigation: function() {\n            var that = this,\n                wrapper = that.wrapper;\n\n            wrapper.on(\"focus\" + NS, function() {\n                var selection = that._selection;\n\n                setTimeout(function() {\n                    if (!that._preventFocus) {\n                        if ((!selection ||\n                                (selection.events.length > 0 && wrapper.find(\"[data-uid='\" + selection.events[0] + \"']\").length === 0)) &&\n                            !that._userTouched &&\n                            !that._mouseDown) {\n                                that._initialFocus();\n                        } else {\n                            that._mouseDown = false;\n                        }\n\n                        that._select();\n                    } else {\n                        that._preventFocus = false;\n                    }\n                }, 300);\n            });\n\n            wrapper.on(\"focusout\" + NS, function() {\n                that._ctrlKey = that._shiftKey = false;\n            });\n\n            wrapper.on(\"keydown\" + NS, that._keydown.bind(that));\n\n            wrapper.on(\"keyup\" + NS, function(e) {\n                that._ctrlKey = e.ctrlKey;\n                that._shiftKey = e.shiftKey;\n            });\n        },\n\n        _selectable: function() {\n            var that = this;\n            var wrapper = that.wrapper;\n\n            if (!that.options.selectable) {\n                return;\n            }\n\n            wrapper.on(MOUSEDOWN + NS, \".k-scheduler-header-all-day td, .k-scheduler-content td, .k-event, .k-scheduler-body td .k-link\", function(e) {\n                if (that._isTouch(e)) {\n                    return;\n                }\n                that._mouseDownSelection(e);\n            });\n\n            var mouseMoveHandler = that._mouseMove.bind(that);\n\n            wrapper.on(MOUSEDOWN + NS, \".k-scheduler-header-all-day td, .k-scheduler-content td\", function(e) {\n                var which = e.which;\n                var button = e.button;\n                var isRight = which && which === 3 || button && button == 2;\n\n                if (that._isTouch(e)) {\n                    return;\n                }\n\n                if (!isRight) {\n                    wrapper.on(MOUSEMOVE + NS, \".k-scheduler-header-all-day td, .k-scheduler-content td\", mouseMoveHandler);\n                }\n            });\n\n            wrapper.on(\"mouseup\" + NS + \" mousecancel\" + NS, function() {\n                wrapper.off(MOUSEMOVE + NS, \".k-scheduler-header-all-day td, .k-scheduler-content td\", mouseMoveHandler);\n            });\n        },\n\n        _mouseDownSelection: function(e) {\n            var which = e.which;\n            var button = e.button;\n            var isRight = which && which === 3 || button && button == 2;\n\n            if (!isRight) {\n                if (e.ctrlKey) {\n                    this._ctrlKey = e.ctrlKey;\n                }\n\n                if (e.shiftKey) {\n                    this._shiftKey = e.shiftKey;\n                }\n\n                this._mouseDown = true;\n                this._createSelection(e.currentTarget);\n\n                if ($(e.currentTarget).hasClass(\"k-event\")) {\n                    this._selection.eventElement = e.currentTarget;\n                }\n            }\n\n            if (kendo._activeElement() !== this.wrapper.get(0)) {\n                kendo.focusElement(this.wrapper);\n            } else {\n                this._select();\n            }\n\n            if (this.toolbar) {\n                this.toolbar.find(\".\" + FOCUSEDSTATE).removeClass(FOCUSEDSTATE);\n            }\n        },\n\n        _selectFirstSlot: function() {\n            var firstAllDay = this.wrapper.find(\".k-scheduler-header-all-day\").find(\"td\").first(),\n                firstContent = this.wrapper.find(\".k-scheduler-content\").find(\"td\").first(),\n                firstSlot;\n\n            if (firstAllDay.length > 0) {\n                firstSlot = firstAllDay;\n            } else if (firstContent.length > 0) {\n                firstSlot = firstContent;\n            } else {\n                firstSlot = this.wrapper.find(\".k-scheduler-body\").find(\".k-link\").first();\n            }\n\n            this._createSelection(firstSlot);\n        },\n\n        _firstEvent: function() {\n            var firstEventInAllDay = this.wrapper.find(\".k-scheduler-header-wrap .k-event, .k-task\").first(),\n                firstEventInContent = this.wrapper.find(\".k-scheduler-content .k-event\").first(),\n                firstEvent, allDayEvent, contentEvent;\n\n            if (firstEventInAllDay.length > 0) {\n                if (firstEventInContent.length > 0) {\n                    allDayEvent = this.occurrenceByUid(firstEventInAllDay.data(\"uid\"));\n                    contentEvent = this.occurrenceByUid(firstEventInContent.data(\"uid\"));\n\n                    firstEvent = allDayEvent.start <= contentEvent.start ? firstEventInAllDay : firstEventInContent;\n                } else {\n                    firstEvent = firstEventInAllDay;\n                }\n            } else if (firstEventInContent) {\n                firstEvent = firstEventInContent;\n            }\n\n            return firstEvent;\n        },\n\n        _initialFocus: function() {\n            var firstEvent = this._firstEvent(),\n                view = this.view();\n\n            if (view.name === \"year\") {\n                if (!view._preventCalendarFocus) {\n                    view.calendar.element.find(\".k-calendar-view\").attr(\"tabindex\", 0);\n                    view.calendar.focus();\n                } else {\n                    view._preventCalendarFocus = false;\n                }\n            } else if (this.options.selectable) {\n                if (firstEvent && firstEvent.length > 0) {\n                    this._createSelection(firstEvent);\n                    this._selection.eventElement = firstEvent[0];\n                } else {\n                    this._selectFirstSlot();\n                }\n            } else if (this.toolbar && this.toolbar.find(\".\" + FOCUSEDSTATE).length === 0) {\n                this._focusToolbar();\n            } else if (this.toolbar) {\n                this.toolbar.find(\".\" + FOCUSEDSTATE).removeClass(FOCUSEDSTATE);\n            }\n        },\n\n        _select: function() {\n            var that = this;\n            var view = that.view();\n            var wrapper = that.wrapper;\n            var current = view.current();\n            var selection = that._selection;\n            var oldSelection = that._old ? that._old.selection : null;\n            var oldEventsLength = that._old ? that._old.eventsLength : null;\n            if (!selection) {\n                return;\n            }\n\n            if (current) {\n                current.removeAttribute(\"id\");\n                wrapper.removeAttr(\"aria-activedescendant\");\n            }\n\n            view.select(selection);\n            that._selection.eventElement = null;\n\n            current = view.current();\n            if (current) {\n                current.setAttribute(\"id\", that._ariaId);\n                wrapper.attr(\"aria-activedescendant\", that._ariaId);\n\n                if (oldSelection !== current || (selection.events && (oldEventsLength !== selection.events.length ))) {\n                    var currentUid = $(current).data(\"uid\");\n\n                    if (that._old && currentUid &&\n                        currentUid === $(that._old.selection).data(\"uid\") &&\n                        (selection.events && that._old.eventsLength === selection.events.length)) {\n                        return;\n                    }\n\n                    var events = that._selectedEvents();\n                    var slots = view._selectedSlots;\n\n                    that._old = {\n                        selection: current,\n                        eventsLength: events.length\n                    };\n\n                    that.trigger(CHANGE, {\n                        start: selection.start,\n                        end: selection.end,\n                        events: events,\n                        slots: slots,\n                        resources: view._resourceBySlot(selection)\n                    });\n                }\n            }\n        },\n\n        _selectedEvents: function() {\n            var uids = this._selection.events;\n            var length = uids.length;\n            var idx = 0;\n            var event;\n\n            var events = [];\n\n            for (; idx < length; idx++) {\n                event = this.occurrenceByUid(uids[idx]);\n                if (event) {\n                    events.push(event);\n                }\n            }\n\n            return events;\n        },\n\n        _tapPosition: function(event, coordinate) {\n            return /touch/.test(event.type) ? (event.originalEvent || event).changedTouches[0]['page' + coordinate] : event['page' + coordinate];\n        },\n\n        _touchMove: function(e) {\n            var that = this;\n            var content = that.wrapper.find(\".k-scheduler-content\");\n            var verticalScroll = content[0].scrollHeight > content[0].clientHeight;\n            var horizontalScroll = content[0].scrollWidth > content[0].clientWidth;\n            var endY = that._tapPosition(e, 'Y');\n            var endX = that._tapPosition(e, 'X');\n            var scrollTop = content[0].scrollTop - Math.round(endY - that._touchPosY);\n            var scrollLeft = content[0].scrollLeft - Math.round(endX - that._touchPosX);\n            var applyVerticalScroll = verticalScroll && Math.abs(endY - that._touchPosY) > 10;\n            var applyhorizontalScroll = horizontalScroll && Math.abs(endY - that._touchPosY) > 10;\n\n\n            if (that._dragging || kendo.support.kineticScrollNeeded || !that._isTouch(e)) {\n                return;\n            }\n\n            if (applyVerticalScroll || applyhorizontalScroll) {\n                that._amplitude = Math.round(endY - that._touchPosY);\n                that._touchPosY = endY;\n                that._touchPosX = endX;\n                content.animate({\n                    scrollTop: scrollTop,\n                    scrollLeft: scrollLeft\n                }, 0);\n                that.view()._scrolling = true;\n            }\n        },\n\n        _mouseMove: function(e) {\n            var that = this;\n            clearTimeout(that._moveTimer);\n\n            if (that._isTouch(e)) {\n                return;\n            }\n\n            that._moveTimer = setTimeout(function() {\n                var view = that.view();\n                var selection = that._selection;\n\n                if (selection) {\n                    var slot = view.selectionByElement($(e.currentTarget));\n\n                    if (slot && selection.groupIndex === slot.groupIndex) {\n                        var startDate = slot.startDate();\n                        var endDate = slot.endDate();\n\n                        if (startDate >= selection.end) {\n                            selection.backward = false;\n                        } else if (endDate <= selection.start) {\n                            selection.backward = true;\n                        }\n\n                        if (selection.backward) {\n                            selection.start = startDate;\n                        } else {\n                            selection.end = endDate;\n                        }\n\n                        that._select();\n                    }\n                }\n            }, 5);\n        },\n\n        _viewByIndex: function(index) {\n            var view, views = this.views;\n\n            for (view in views) {\n                if (!index) {\n                    return view;\n                }\n\n                index--;\n            }\n        },\n\n        _keydownToolbar: function(e) {\n            var key = e.keyCode,\n                focusableToolBarSelector = \"> .k-button,\" +\n                    \".k-scheduler-navigation > .k-button,\" +\n                    \".k-nav-current,\" +\n                    \".k-views-dropdown:visible,\" +\n                    \".k-scheduler-views:visible > .k-button,\" +\n                    \".k-scheduler-search-input,\" +\n                    \".k-scheduler-mobile-views,\" +\n                    \".k-button-group > .k-button\",\n                focusableItems = this.toolbar.find(focusableToolBarSelector),\n                shouldNavigate = $(e.target).closest(VIEWSSELECTOR).length || this.toolbar.find('.k-scheduler-views .k-focus').length,\n                isRtl = kendo.support.isRtl(this.element),\n                focusedItem = this.toolbar.find(\".\" + FOCUSEDSTATE + \", :focus\"),\n                idx = focusableItems.index(focusedItem),\n                itemToFocus;\n\n            if (key === keys.TAB && (!e.shiftKey || this.options.selectable)) {\n                this.toolbar.find(\".\" + FOCUSEDSTATE).removeClass(FOCUSEDSTATE);\n            } else if (e.altKey && key === keys.DOWN && this.toolbar.find(\".k-nav-current\").hasClass(FOCUSEDSTATE)) {\n                this._showCalendar();\n                e.preventDefault();\n                return;\n            } else if (key === keys.RIGHT || key === keys.LEFT) {\n                if ((key === keys.RIGHT && !isRtl) || (key === keys.LEFT && isRtl)) {\n\n                    idx = idx + 1;\n\n                    if (idx === focusableItems.length) {\n                        this.toolbar.find(\".\" + FOCUSEDSTATE).removeClass(FOCUSEDSTATE);\n                        this.element.focus();\n\n                        return;\n                    }\n                } else if ((key === keys.LEFT && !isRtl) || (key === keys.RIGHT && isRtl)) {\n                    idx = idx - 1;\n\n                    if (idx < 0) {\n                        return;\n                    }\n                }\n\n                itemToFocus = focusableItems[idx];\n\n                this.toolbar.find(\".\" + FOCUSEDSTATE).removeClass(FOCUSEDSTATE);\n                $(itemToFocus).addClass(FOCUSEDSTATE).attr(\"tabindex\", 0).focus().attr(\"tabindex\", -1);\n                this._focusedView = null;\n                e.preventDefault();\n\n                return;\n            } else if (key === keys.ENTER || key === keys.SPACEBAR) {\n                if (shouldNavigate && this._focusedView && !this._focusedView.hasClass(\"k-selected\")) {\n                    var focusedViewName = this._focusedView.data().name;\n\n                    if (!this.trigger(\"navigate\", { view: focusedViewName, action: \"changeView\", date: this.date() })) {\n                        this.view(focusedViewName);\n                    }\n                    e.preventDefault();\n                    return;\n                }\n\n                this.toolbar.find(\".\" + FOCUSEDSTATE + ':visible').click();\n                e.preventDefault();\n\n                return;\n            } else if (key === keys.DOWN && !this.wrapper.find(\".k-views-dropdown\").hasClass(\"k-focus\")) {\n                this.toolbar.find(\".\" + FOCUSEDSTATE).removeClass(FOCUSEDSTATE);\n\n                if (this._selectedViewName === \"year\") {\n                    this.view().calendar.element.find(\".k-calendar-view\").attr(\"tabindex\", 0);\n                    this.view().calendar.focus();\n                } else if (document.activeElement !== this.element[0]) {\n                    this.element.focus();\n                }\n\n                e.preventDefault();\n\n                return;\n            }\n        },\n\n        _keydownView: function(e) {\n            var key = e.keyCode,\n                isModifier = key === 16 || key === 18 || key === 17 || key === 91 || key === 92,\n                selection = this._selection,\n                view = this.view(),\n                editable = view.options.editable,\n                arrowKeys = [ keys.LEFT, keys.RIGHT, keys.UP, keys.DOWN ],\n                isRtl = kendo.support.isRtl(this.element),\n                previous, content, cell;\n\n            if (isModifier) {\n                return;\n            }\n\n            // slots selection via keyboard is no longer available\n            // see here: https://github.com/telerik/kendo-themes/blob/develop/docs/accessibility/Scheduler.md\n            if (!selection) {\n                return;\n            }\n\n            if (key === keys.ENTER) {\n                if (selection.events.length && editable) {\n                    if (editable.update !== false) {\n                        this.editEvent(selection.events[0]);\n                    }\n                }\n            } else if ((key === keys.DELETE || key === keys.BACKSPACE) && editable !== false && editable.destroy !== false) {\n                this.removeEvent(selection.events[0]);\n            } else if (arrowKeys.indexOf(key) > -1) {\n                previous = key === keys.UP || (key === keys.LEFT && !isRtl) || (key === keys.RIGHT && isRtl);\n\n                if (view.moveToEvent(selection, previous)) {\n                    this._select();\n\n                    // Focus the Scheduler element only if it not the currently focused element\n                    if (document.activeElement !== this.element[0]) {\n                        this.element.focus();\n                    }\n\n                    e.preventDefault();\n                }\n            } else if (key === keys.HOME || key === keys.END) {\n                e.preventDefault();\n                content = this.view().content.eq(0);\n\n                if (key === keys.HOME) {\n                    cell = content.find(\".k-scheduler-table td\").first();\n                } else {\n                    cell = content.find(\".k-scheduler-table td\").last();\n                }\n\n                this.view()._scrollTo(cell[0], content[0]);\n            }\n        },\n\n        _keydownShortcut: function(key) {\n            var currentDate = new Date(),\n                timezone = this.options.timezone,\n                editable = this.view().options.editable;\n\n            if (key === 66 && !!this.view().toggleFullDay) {\n                this.view().toggleFullDay();\n            } else if (key === 67 && editable && editable.create !== false) {\n                this.addEvent(extend({}, {\n                    start: this.date(),\n                    end: this.date()\n                }));\n            } else if (key === 84) {\n                if (timezone) {\n                    var timezoneOffset = kendo.timezone.offset(currentDate, timezone);\n                    date = kendo.timezone.convert(currentDate, currentDate.getTimezoneOffset(), timezoneOffset);\n                } else {\n                    date = currentDate;\n                }\n\n                if (!this.trigger(\"navigate\", { view: this._selectedViewName, action: \"today\", date: date })) {\n                    this.date(date);\n                }\n            }\n        },\n\n        _keydownYearView: function(e) {\n            var view = this.view(),\n                selection = this._selection,\n                key = e.keyCode;\n\n            if (key === keys.TAB) {\n                return;\n            }\n\n            if (key === keys.F10) {\n                view.calendar.element.find(\".k-calendar-view\").removeAttr(\"tabindex\");\n                this._focusToolbar();\n                e.preventDefault();\n            } else {\n                this.toolbar.find(\".\" + FOCUSEDSTATE).removeClass(FOCUSEDSTATE);\n                view.calendar.element.find(\".k-calendar-view\").attr(\"tabindex\", 0);\n                view.calendar.focus();\n            }\n\n            if (selection) {\n                this._adjustSelectedDate();\n            }\n\n            e.preventDefault();\n        },\n\n        _keydownAgendaView: function(e) {\n            var key = e.keyCode,\n                view = this.view(),\n                selection = this._selection,\n                content, cell;\n\n            if (view.move(selection, key)) {\n                e.preventDefault();\n                this.toolbar.find(\".\" + FOCUSEDSTATE).removeClass(FOCUSEDSTATE);\n                this._select();\n            } else if (key === keys.HOME || key === keys.END) {\n                e.preventDefault();\n                content = this.view().content.eq(0);\n\n                if (key === keys.HOME) {\n                    cell = content.find(\".k-scheduler-table td\").first();\n                } else {\n                    cell = content.find(\".k-scheduler-table td\").last();\n                }\n\n                this.view()._scrollTo(cell[0], content[0]);\n            }\n        },\n\n        _keydownChangeView: function(key) {\n            var viewIndex = key - 49,\n                viewByIndex;\n\n            if (viewIndex === -1) {\n                viewIndex = 9;\n            }\n\n            viewByIndex = this._viewByIndex(viewIndex);\n\n            if (viewByIndex && !this.trigger(\"navigate\", { view: viewByIndex, action: \"changeView\", date: this.date() })) {\n                this.view(viewByIndex);\n            }\n        },\n\n        _keydownChangeDate: function(key) {\n            var isRtl = kendo.support.isRtl(this.element),\n                direction = (isRtl && key === keys.LEFT) || (!isRtl && key === keys.RIGHT) ? \"next\" : \"previous\";\n\n            if (direction === \"next\") {\n                date = this.view().nextDate();\n            } else {\n                date = this.view().previousDate();\n            }\n\n            if (!this.trigger(\"navigate\", { view: this._selectedViewName, action: direction, date: date })) {\n                this.date(date);\n                this._initialFocus();\n                this._select();\n            }\n        },\n\n        _keydown: function(e) {\n            var key = e.keyCode,\n                shortcutKeys = [66, 67, 84],\n                toolbarIsFocused = $(e.target).closest(\".k-toolbar\").length > 0,\n                altKey = e.altKey;\n\n            this._ctrlKey = e.ctrlKey;\n            this._shiftKey = e.shiftKey;\n\n            if (key === keys.ESC && this.popup && this.popup.visible()) {\n                this.popup.close();\n                e.preventDefault();\n                return;\n            }\n\n            if ((key === keys.LEFT || key === keys.RIGHT) && this._shiftKey) {\n                this._keydownChangeDate(key);\n                return;\n            }\n\n            if (altKey && key >= 48 && key <= 57) {\n                this._keydownChangeView(key);\n                return;\n            }\n\n            if (shortcutKeys.indexOf(key) > -1) {\n                this._keydownShortcut(key);\n                return;\n            }\n\n            if (toolbarIsFocused) {\n                this._keydownToolbar(e);\n            } else {\n                if (this._selectedViewName === \"year\") {\n                    this._keydownYearView(e);\n                    return;\n                }\n\n                if (key === keys.F10) {\n                    this._focusToolbar();\n                    e.preventDefault();\n                    return;\n                }\n\n                if (this._selectedViewName === \"agenda\") {\n                    this._keydownAgendaView(e);\n                    return;\n                }\n\n                this._keydownView(e);\n            }\n        },\n\n        _focusToolbar: function() {\n            this.toolbar.find(\".k-button\").first()\n                .trigger(\"focus\")\n                .addClass(FOCUSEDSTATE);\n        },\n\n        _createSelection: function(item) {\n            var selection = this._selection,\n                uid, slot;\n\n            item = $(item);\n\n            if (item.is(\".k-event\")) {\n                uid = item.attr(kendo.attr(\"uid\"));\n\n                if (selection && selection.events.indexOf(uid) !== -1 && !this._ctrlKey) {\n                    return;\n                }\n            }\n\n            if (!selection || (!this._ctrlKey && !this._shiftKey)) {\n                selection = this._selection = {\n                    events: [],\n                    groupIndex: 0\n                };\n            }\n\n            slot = this.view().selectionByElement(item);\n\n            if (slot) {\n                selection.groupIndex = slot.groupIndex || 0;\n            }\n\n            if (uid) {\n                slot = getOccurrenceByUid(this._data, uid);\n            }\n\n            if (slot && slot.uid) {\n                uid = [slot.uid];\n            }\n\n            this._updateSelection(slot, uid);\n            this._adjustSelectedDate();\n        },\n\n        _updateSelection: function(dataItem, events, groupIndex) {\n            var selection = this._selection;\n\n            if (dataItem && selection) {\n                var view = this.view();\n\n                if (dataItem.uid) {\n                    dataItem = view._updateEventForSelection(dataItem);\n                }\n\n                if (this._shiftKey && selection.start && selection.end) {\n                    var backward = dataItem.end < selection.end;\n\n                    selection.end = dataItem.endDate ? dataItem.endDate() : dataItem.end;\n\n                    if (backward && view._timeSlotInterval) {\n                        kendo.date.setTime(selection.end, -view._timeSlotInterval());\n                    }\n                } else {\n                    selection.start = dataItem.startDate ? dataItem.startDate() : dataItem.start;\n                    selection.end = dataItem.endDate ? dataItem.endDate() : dataItem.end;\n                }\n\n                if (\"isDaySlot\" in dataItem) {\n                    selection.isAllDay = dataItem.isDaySlot;\n                } else {\n                    selection.isAllDay = dataItem.isAllDay;\n                }\n\n                if (groupIndex !== null && groupIndex !== undefined) {\n                    selection.groupIndex = groupIndex;\n                }\n\n                selection.index = dataItem.index;\n                if (this._ctrlKey) {\n                    var indexOfEvent = (events && events.length) ? selection.events.indexOf(events[0]) : -1;\n\n                    if (indexOfEvent > -1) {\n                        selection.events.splice(indexOfEvent, 1);\n                    } else {\n                        selection.events = selection.events.concat(events || []);\n                    }\n                } else {\n                        selection.events = events || [];\n                }\n            }\n        },\n\n        options: {\n            name: \"Scheduler\",\n            date: TODAY,\n            editable: true,\n            autoBind: true,\n            snap: true,\n            mobile: false,\n            timezone: \"\",\n            allDaySlot: true,\n            min: new Date(1900, 0, 1),\n            max: new Date(2099, 11, 31),\n            toolbar: null,\n            workWeekStart: 1,\n            workWeekEnd: 5,\n            workDays: null,\n            showWorkHours: false,\n            startTime: TODAY,\n            endTime: TODAY,\n            currentTimeMarker: {\n                updateInterval: 10000,\n                useLocalTimezone: true\n            },\n            footer: {},\n            messages: {\n                today: \"Today\",\n                pdf: \"Export to PDF\",\n                save: \"Save\",\n                cancel: \"Cancel\",\n                destroy: \"Delete\",\n                resetSeries: \"Reset Series\",\n                deleteWindowTitle: \"Delete event\",\n                next: \"Next\",\n                previous: \"Previous\",\n                refresh: \"Refresh\",\n                selectView: \"Select view\",\n                ariaSlotLabel: \"Selected from {0:t} to {1:t}\",\n                ariaEventLabel: {\n                    on: \"on\",\n                    at: \"at\",\n                    to: \"to\",\n                    allDay: \"(all day)\",\n                    prefix: \"\"\n                },\n                search: \"Search...\",\n                views: {\n                    day: \"Day\",\n                    week: \"Week\",\n                    workWeek: \"Work Week\",\n                    agenda: \"Agenda\",\n                    month: \"Month\",\n                    timeline: \"Timeline\",\n                    timelineWeek: \"Timeline Week\",\n                    timelineWorkWeek: \"Timeline Work Week\",\n                    timelineMonth: \"Timeline Month\",\n                    year: \"Year\"\n                },\n                recurrenceMessages: {\n                    deleteWindowTitle: \"Delete Recurring Item\",\n                    resetSeriesWindowTitle: \"Reset Series\",\n                    deleteWindowOccurrence: \"Delete current occurrence\",\n                    deleteWindowSeries: \"Delete the series\",\n                    editWindowTitle: \"Edit Recurring Item\",\n                    editWindowOccurrence: \"Edit current occurrence\",\n                    editWindowSeries: \"Edit the series\"\n                },\n                editable: {\n                    confirmation: DELETECONFIRM\n                },\n                editor: {\n                    title: \"Title\",\n                    start: \"Start\",\n                    end: \"End\",\n                    allDayEvent: \"All day event\",\n                    description: \"Description\",\n                    repeat: \"Repeat\",\n                    timezone: \"Timezone\",\n                    startTimezone: \"Start timezone\",\n                    endTimezone: \"End timezone\",\n                    separateTimezones: \"Use separate start and end time zones\",\n                    timezoneEditorTitle: \"Timezones\",\n                    timezoneEditorButton: \"Time zone\",\n                    timezoneTitle: \"Time zones\",\n                    noTimezone: \"No timezone\",\n                    editorTitle: \"Event\"\n                }\n            },\n            height: null,\n            width: null,\n            resources: [],\n            group: {\n                resources: [],\n                orientation: \"horizontal\"\n            },\n            views: [],\n            selectable: false\n        },\n\n        events: [\n            REMOVE,\n            EDIT,\n            CANCEL,\n            SAVE,\n            \"add\",\n            \"dataBinding\",\n            \"dataBound\",\n            \"moveStart\",\n            \"move\",\n            \"moveEnd\",\n            \"resizeStart\",\n            \"resize\",\n            \"resizeEnd\",\n            \"navigate\",\n            CHANGE\n        ],\n\n        destroy: function() {\n            var that = this,\n                element;\n\n            Widget.fn.destroy.call(that);\n\n            if (that.dataSource) {\n                that.dataSource.unbind(CHANGE, that._refreshHandler);\n                that.dataSource.unbind(PROGRESS, that._progressHandler);\n                that.dataSource.unbind(ERROR, that._errorHandler);\n            }\n\n            if (that._resourceRefreshHandler) {\n                for (var idx = 0; idx < that.resources.length; idx++) {\n                    var resourceDS = that.resources[idx].dataSource;\n                    resourceDS.unbind(CHANGE, that._resourceRefreshHandler);\n                    resourceDS.unbind(PROGRESS, that._resourceProgressHandler);\n                    resourceDS.unbind(ERROR, that._resourceErrorHandler);\n                }\n            }\n\n            if (that.calendar) {\n                that.calendar.destroy();\n                that.popup.destroy();\n            }\n\n            if (that.view()) {\n                that.view().destroy();\n            }\n\n            if (that._editor) {\n                that._editor.destroy();\n            }\n\n            if (this._moveDraggable) {\n                this._moveDraggable.destroy();\n            }\n\n            if (this._resizeDraggable) {\n                this._resizeDraggable.destroy();\n            }\n\n            element = that.element\n                .add(that.wrapper)\n                .add(that.toolbar)\n                .add(that.popup);\n\n            element.off(NS);\n\n            clearTimeout(that._moveTimer);\n\n            that._model = null;\n            that.toolbar = null;\n            that.element = null;\n\n            $(window).off(\"resize\" + NS, that._resizeHandler);\n\n            kendo.destroy(that.wrapper);\n        },\n\n        setDataSource: function(dataSource) {\n            this.options.dataSource = dataSource;\n\n            this._dataSource();\n\n            if (this.options.autoBind && dataSource.fetch) {\n                dataSource.fetch();\n            } else if (isArray(dataSource)) {\n                this.view(this._selectedView);\n            }\n        },\n\n        items: function() {\n            var content = this.wrapper.find(\".k-scheduler-content\");\n            var view = this.view();\n\n            if (view && view.options.name === \"agenda\") {\n                return content.find(\".k-task\");\n            } else {\n                return content.find(\".k-event\")\n                              .add(this.wrapper.find(\".k-scheduler-header-wrap\")\n                                       .find(\".k-scheduler-header-all-day\").siblings());\n            }\n        },\n\n        _movable: function() {\n            var startSlot;\n            var endSlot;\n            var startResources;\n            var startTime;\n            var endTime;\n            var event;\n            var clonedEvent;\n            var that = this;\n            var originSlot;\n            var originStartTime;\n            var originalEvent;\n            var distance = 0;\n            var clonedEvents = [];\n            var cachedEvents = [];\n\n            var isMobile = that._isMobile();\n            var movable = that.options.editable && that.options.editable.move !== false;\n            var resizable = that.options.editable && that.options.editable.resize !== false;\n\n            if (movable || (resizable && isMobile)) {\n                that._dragging = false;\n                if (isMobile && kendo.support.mobileOS.android) {\n                    distance = 5;\n                }\n\n                that._moveDraggable = new kendo.ui.Draggable(that.element, {\n                    distance: distance,\n                    filter: \".k-event\",\n                    ignore: \".k-resize-handle\",\n                    holdToDrag: isMobile,\n                    autoScroll: true\n                });\n\n                if (movable) {\n                    that._moveDraggable.bind(\"dragstart\", function(e) {\n                        var view = that.view();\n                        var eventElement = e.currentTarget;\n                        var isTouch = that._isTouch(e);\n                        that._dragging = true;\n\n                        if (!view.options.editable || view.options.editable.move === false) {\n                            that._dragging = false;\n                            e.preventDefault();\n                            return;\n                        }\n\n                        if (isTouch && !eventElement.hasClass(\"k-event-active\")) {\n                            that._dragging = false;\n                            that.element.find(\".k-event-active\").removeClass(\"k-event-active\");\n                            e.preventDefault();\n                            return;\n                        }\n\n                        event = that.occurrenceByUid(eventElement.attr(kendo.attr(\"uid\")));\n\n                        clonedEvent = event.clone();\n                        originalEvent = event.clone();\n\n                        clonedEvent.update(view._eventOptionsForMove(clonedEvent));\n\n                        clonedEvent.inverseColor = that._isInverseColor(eventElement);\n\n                        clonedEvents = [];\n                        if (that._selection) {\n                            var events = that._selection.events;\n\n                            for (var i = 0; i < events.length; i++) {\n                                var evtClone = that.occurrenceByUid(events[i]).clone();\n                                var evtCloneElement = this.element.find('div.k-event[data-uid=\"' + evtClone.uid + '\"]').eq(0);\n\n                                evtClone.update(view._eventOptionsForMove(evtClone));\n\n                                if (evtCloneElement.length) {\n                                    evtClone.inverseColor = that._isInverseColor(evtCloneElement);\n                                }\n\n                                clonedEvents.push(evtClone);\n                            }\n                        } else {\n                            clonedEvents.push(clonedEvent);\n                        }\n\n                        startSlot = view._slotByPosition(e.x.startLocation, e.y.startLocation);\n                        startResources = view._resourceBySlot(startSlot);\n\n                        originStartTime = startTime = startSlot.startOffset(e.x.startLocation, e.y.startLocation, that.options.snap);\n\n                        endSlot = startSlot;\n\n                        originSlot = startSlot;\n\n                        if (!startSlot || that.trigger(\"moveStart\", { event: event })) {\n                            e.preventDefault();\n                        }\n                    })\n                    .bind(\"drag\", function(e) {\n                        var view = that.view();\n                        var slot = view._slotByPosition(e.x.location, e.y.location);\n                        var distance;\n                        var range;\n                        var i;\n\n                        if (!slot) {\n                            return;\n                        }\n\n                        endTime = slot.startOffset(e.x.location, e.y.location, that.options.snap);\n\n                        if (slot.isDaySlot !== startSlot.isDaySlot) {\n\n                            if (slot.isDaySlot !== originSlot.isDaySlot) {\n                                var slotIndex = $(startSlot.element).index();\n\n                                var targetSlotElement = $(slot.element).parent().children().eq(slotIndex);\n\n                                startSlot = view._slotByPosition(targetSlotElement.offset().left, targetSlotElement.offset().top);\n\n                                startTime = startSlot.startOffset(e.x.location, e.y.location, true);\n\n                                cachedEvents = clonedEvents.map(function(event) { return event.clone(); });\n\n                                for (i = 0; i < clonedEvents.length; i++) {\n                                    if (clonedEvents[i].isAllDay != slot.isDaySlot) {\n                                        clonedEvents[i].isAllDay = slot.isDaySlot;\n\n                                        clonedEvents[i].end = kendo.date.getDate(clonedEvents[i].start);\n                                        clonedEvents[i].start = kendo.date.getDate(clonedEvents[i].start);\n\n                                        if (!slot.isDaySlot) {\n                                            kendo.date.setTime(clonedEvents[i].start, kendo.date.getMilliseconds(view.startTime()));\n                                            kendo.date.setTime(clonedEvents[i].end, kendo.date.getMilliseconds(view.startTime()) + view._timeSlotInterval());\n                                        }\n                                    }\n                                }\n                            } else {\n                                startSlot = $.extend(true, { }, originSlot);\n                                startTime = originStartTime;\n\n                                clonedEvents = cachedEvents;\n                            }\n                        }\n\n                        distance = endTime - startTime;\n\n                        for (i = 0; i < clonedEvents.length; i++) {\n                            view._updateMoveHint(clonedEvents[i], slot.groupIndex, distance);\n                        }\n\n                        range = moveEventRange(clonedEvent, distance);\n\n                        if (!that.trigger(\"move\", {\n                            event: event,\n                            slot: { element: slot.element, start: slot.startDate(), end: slot.endDate(), isDaySlot: slot.isDaySlot },\n                            resources: view._resourceBySlot(slot),\n                            start: range.start,\n                            end: range.end\n                        })) {\n                            endSlot = slot;\n                        } else {\n                            for (i = 0; i < clonedEvents.length; i++) {\n                                view._updateMoveHint(clonedEvents[i], slot.groupIndex, distance);\n                            }\n                        }\n                    })\n                    .bind(\"dragend\", function(e) {\n                        that.view()._removeMoveHint();\n                        var distance = endTime - startTime;\n                        var range = moveEventRange(clonedEvent, distance);\n                        var start = range.start;\n                        var end = range.end;\n                        that._dragging = false;\n\n                        var endResources = that.view()._resourceBySlot(endSlot);\n\n                        var prevented = that.trigger(\"moveEnd\", {\n                            event: event,\n                            slot: { element: endSlot.element, start: endSlot.startDate(), end: endSlot.endDate() },\n                            start: start,\n                            end: end,\n                            resources: endResources\n                        });\n\n                        if (!prevented && (event.start.getTime() !== start.getTime() ||\n                            event.end.getTime() !== end.getTime() ||\n                            originSlot.isDaySlot !== endSlot.isDaySlot ||\n                            kendo.stringify(endResources) !== kendo.stringify(startResources))) {\n\n                            that._isMultiDrag = clonedEvents.length > 1;\n\n                            for (var i = 0; i < clonedEvents.length; i++) {\n                                var evt = clonedEvents[i];\n\n                                range = moveEventRange(evt, distance);\n\n                                var updatedEventOptions = that.view()._eventOptionsForMove(evt);\n                                var eventOptions = $.extend(\n                                    {\n                                        isAllDay: evt.isAllDay,\n                                        start: range.start,\n                                        end: range.end\n                                    },\n                                    updatedEventOptions,\n                                    endResources\n                                );\n\n                                that._updateEvent(null, evt, eventOptions);\n                            }\n\n                            if (that._isMultiDrag) {\n                                that.dataSource.sync();\n                                that._isMultiDrag = false;\n                            }\n                        }\n\n                        e.currentTarget.removeClass(\"k-event-active\");\n                        this.cancelHold();\n                        clonedEvents = [];\n                        cachedEvents = [];\n                    })\n                    .bind(\"dragcancel\", function() {\n                        that.view()._removeMoveHint();\n                        this.cancelHold();\n                        clonedEvents = [];\n                        cachedEvents = [];\n                    });\n                }\n\n                that._moveDraggable.bind(\"hold\", function(e) {\n                    if (that._isTouch(e)) {\n                        that.element.find(\".k-event-active\").removeClass(\"k-event-active\");\n                        if (that.options.selectable) {\n                            that._createSelection(e.currentTarget);\n                        }\n                        e.currentTarget.addClass(\"k-event-active\");\n                    }\n                });\n            }\n        },\n\n        _resizable: function() {\n            var startTime;\n            var endTime;\n            var event;\n            var clonedEvent;\n            var slot;\n            var that = this;\n            var distance = 0;\n\n            function direction(handle) {\n                var directions = {\n                    \"k-resize-e\": \"east\",\n                    \"k-resize-w\": \"west\",\n                    \"k-resize-n\": \"north\",\n                    \"k-resize-s\": \"south\"\n                };\n\n                for (var key in directions) {\n                    if (handle.hasClass(key)) {\n                        return directions[key];\n                    }\n                }\n            }\n\n            if (that._isMobile() && kendo.support.mobileOS.android) {\n                distance = 5;\n            }\n\n            that._resizeDraggable = new kendo.ui.Draggable(that.element, {\n                distance: distance,\n                filter: \".k-resize-handle\",\n                autoScroll: true,\n                dragstart: function(e) {\n                    var dragHandle = $(e.currentTarget);\n\n                    var eventElement = dragHandle.closest(\".k-event\");\n\n                    var uid = eventElement.attr(kendo.attr(\"uid\"));\n\n                    var view = that.view();\n\n                    that._dragging = true;\n                    event = that.occurrenceByUid(uid);\n\n                    clonedEvent = event.clone();\n\n                    view._updateEventForResize(clonedEvent);\n\n                    slot = view._slotByPosition(e.x.startLocation, e.y.startLocation);\n\n                    if (that.trigger(\"resizeStart\", { event: event })) {\n                        e.preventDefault();\n                    }\n\n                    startTime = kendo.date.toUtcTime(clonedEvent.start);\n\n                    endTime = kendo.date.toUtcTime(clonedEvent.end);\n                },\n                drag: function(e) {\n                    if (!slot) {\n                        return;\n                    }\n\n                    var dragHandle = $(e.currentTarget);\n\n                    var dir = direction(dragHandle);\n\n                    var view = that.view();\n\n                    var currentSlot = view._slotByPosition(e.x.location, e.y.location);\n\n                    if (!currentSlot || slot.groupIndex != currentSlot.groupIndex) {\n                        return;\n                    }\n\n                    slot = currentSlot;\n\n                    var originalStart = startTime;\n\n                    var originalEnd = endTime;\n\n                    if (dir == \"south\") {\n                        if (!slot.isDaySlot && slot.end - kendo.date.toUtcTime(clonedEvent.start) >= view._timeSlotInterval()) {\n                            if (clonedEvent.isAllDay) {\n                                endTime = slot.startOffset(e.x.location, e.y.location, that.options.snap);\n                            } else {\n                                endTime = slot.endOffset(e.x.location, e.y.location, that.options.snap);\n                            }\n                        }\n                    } else if (dir == \"north\") {\n                        if (!slot.isDaySlot && kendo.date.toUtcTime(clonedEvent.end) - slot.start >= view._timeSlotInterval()) {\n                            startTime = slot.startOffset(e.x.location, e.y.location, that.options.snap);\n                        }\n                    } else if (dir == \"east\") {\n                        if (slot.isDaySlot && kendo.date.toUtcTime(kendo.date.getDate(slot.endDate())) >= kendo.date.toUtcTime(kendo.date.getDate(clonedEvent.start))) {\n                            if (clonedEvent.isAllDay) {\n                                endTime = slot.startOffset(e.x.location, e.y.location, that.options.snap);\n                            } else {\n                                endTime = slot.endOffset(e.x.location, e.y.location, that.options.snap);\n                            }\n                        } else if (!slot.isDaySlot && slot.end - kendo.date.toUtcTime(clonedEvent.start) >= view._timeSlotInterval()) {\n                            endTime = slot.endOffset(e.x.location, e.y.location, that.options.snap);\n                        }\n                    } else if (dir == \"west\") {\n                        if (slot.isDaySlot && kendo.date.toUtcTime(kendo.date.getDate(clonedEvent.end)) >= kendo.date.toUtcTime(kendo.date.getDate(slot.startDate()))) {\n                            startTime = slot.startOffset(e.x.location, e.y.location, that.options.snap);\n                        } else if (!slot.isDaySlot && kendo.date.toUtcTime(clonedEvent.end) - slot.start >= view._timeSlotInterval()) {\n                            startTime = slot.startOffset(e.x.location, e.y.location, that.options.snap);\n                        }\n                    }\n\n                    if (!that.trigger(\"resize\", {\n                        event: event,\n                        slot: { element: slot.element, start: slot.startDate(), end: slot.endDate() },\n                        start: kendo.timezone.toLocalDate(startTime),\n                        end: kendo.timezone.toLocalDate(endTime),\n                        resources: view._resourceBySlot(slot)\n                    })) {\n                        view._updateResizeHint(clonedEvent, slot.groupIndex, startTime, endTime);\n                    } else {\n                        startTime = originalStart;\n                        endTime = originalEnd;\n                    }\n                },\n                dragend: function(e) {\n                    var dragHandle = $(e.currentTarget);\n                    var start = new Date(clonedEvent.start.getTime());\n                    var end = new Date(clonedEvent.end.getTime());\n                    var dir = direction(dragHandle);\n\n                    that._dragging = false;\n                    that.view()._removeResizeHint();\n\n                    if (dir == \"south\") {\n                        end = kendo.timezone.toLocalDate(endTime);\n                    } else if (dir == \"north\") {\n                        start = kendo.timezone.toLocalDate(startTime);\n                    } else if (dir == \"east\") {\n                        if (slot.isDaySlot) {\n                            end = kendo.date.getDate(kendo.timezone.toLocalDate(endTime));\n                        } else {\n                            end = kendo.timezone.toLocalDate(endTime);\n                        }\n                    } else if (dir == \"west\") {\n                        if (slot.isDaySlot) {\n                            start = new Date(kendo.timezone.toLocalDate(startTime));\n                            start.setHours(0);\n                            start.setMinutes(0);\n                        } else {\n                            start = kendo.timezone.toLocalDate(startTime);\n                        }\n                    }\n\n                    var prevented = that.trigger(\"resizeEnd\", {\n                        event: event,\n                        slot: { element: slot.element, start: slot.startDate(), end: slot.endDate() },\n                        start: start,\n                        end: end,\n                        resources: that.view()._resourceBySlot(slot)\n                    });\n\n                    if (!prevented && end.getTime() >= start.getTime()) {\n                        if (clonedEvent.start.getTime() != start.getTime() || clonedEvent.end.getTime() != end.getTime()) {\n                            that.view()._updateEventForResize(event);\n                            that._updateEvent(dir, event, { start: start, end: end });\n                        }\n                    }\n\n                    slot = null;\n                    event = null;\n                },\n                dragcancel: function() {\n                    that._dragging = false;\n                    that.view()._removeResizeHint();\n\n                    slot = null;\n                    event = null;\n                }\n            });\n        },\n\n        _updateEvent: function(dir, event, eventInfo) {\n            var that = this;\n\n            var updateEvent = function(event, callback) {\n                var start;\n\n                try {\n                    that._preventRefresh = true;\n                    event.update(eventInfo);\n                    that._convertDates(event);\n                    start = event.start;\n\n                    if (dir && event.duration() % MS_PER_DAY === 0 && start.getHours() === 0 && start.getMinutes() === 0 && start.getSeconds() === 0 && start.getMilliseconds() === 0) {\n                        event.set(\"isAllDay\", true);\n                    }\n                } finally {\n                    that._preventRefresh = false;\n                }\n\n                if (!that.trigger(SAVE, { event: event })) {\n                    if (callback) {\n                        callback();\n                    }\n\n                    if (!that._isMultiDrag) {\n                        that.dataSource.sync();\n                    }\n                }\n            };\n\n            var recurrenceHead = function(event) {\n                if (event.recurrenceRule) {\n                    return that.dataSource.getByUid(event.uid);\n                } else {\n                    return that.dataSource.get(event.recurrenceId);\n                }\n            };\n\n            var updateSeries = function() {\n                var head = recurrenceHead(event);\n\n                if (dir == \"south\" || dir == \"north\") {\n                    if (eventInfo.start) {\n                        var start = kendo.date.getDate(head.start);\n                        kendo.date.setTime(start, getMilliseconds(eventInfo.start));\n                        eventInfo.start = start;\n                    }\n                    if (eventInfo.end) {\n                        var end = kendo.date.getDate(head.end);\n                        kendo.date.setTime(end, getMilliseconds(eventInfo.end));\n                        eventInfo.end = end;\n                    }\n                }\n\n                that.dataSource._removeExceptions(head);\n\n                updateEvent(head);\n            };\n\n            var updateOccurrence = function() {\n                var head = recurrenceHead(event);\n                var eventUid;\n\n                var callback = function() {\n                    that._convertDates(head);\n\n                    if (that._selection) {\n                        that._selection.events.push(eventUid);\n                    }\n                };\n\n                var exception = head.toOccurrence({ start: event.start, end: event.end });\n\n                eventUid = exception.uid;\n\n                updateEvent(that.dataSource.add(exception), callback);\n            };\n\n            if (event.recurrenceRule || event.isOccurrence()) {\n                var recurrenceMessages = that.options.messages.recurrenceMessages;\n\n                that._showRecurringDialog(event, updateOccurrence, updateSeries,{\n                    title: recurrenceMessages.editWindowTitle,\n                    text: recurrenceMessages.editRecurring ? recurrenceMessages.editRecurring : EDITRECURRING,\n                    occurrenceText: recurrenceMessages.editWindowOccurrence,\n                    seriesText: recurrenceMessages.editWindowSeries\n                });\n            } else {\n                updateEvent(that.dataSource.getByUid(event.uid));\n            }\n        },\n\n        _modelForContainer: function(container) {\n            container = $(container).closest(\"[\" + kendo.attr(\"uid\") + \"]\");\n\n            return this.dataSource.getByUid(container.attr(kendo.attr(\"uid\")));\n        },\n\n        showDialog: function(options) {\n            this.toolbar.find(\".\" + FOCUSEDSTATE).removeClass(FOCUSEDSTATE);\n            this._editor.showDialog(options);\n        },\n\n        focus: function() {\n            this.wrapper.trigger(\"focus\");\n        },\n\n        _confirmation: function(callback, model, isResetSeries) {\n            var editable = this.options.editable;\n\n            if (editable === true || editable.confirmation !== false) {\n                var messages = this.options.messages;\n                var title = messages.deleteWindowTitle;\n                var text = typeof editable.confirmation === STRING ? editable.confirmation : messages.editable.confirmation;\n\n                if (this._isEditorOpened() && model.isRecurring()) {\n                    var recurrenceMessages = this.options.messages.recurrenceMessages;\n                    title = recurrenceMessages.deleteWindowTitle;\n\n                    if (model.isException() || model.isNew()) {\n                        text = recurrenceMessages.deleteRecurringConfirmation ? recurrenceMessages.deleteRecurringConfirmation : DELETERECURRINGCONFIRM;\n                    } else {\n                        text = recurrenceMessages.deleteSeriesConfirmation ? recurrenceMessages.deleteSeriesConfirmation : DELETESERIESCONFIRM;\n                    }\n\n                    if (isResetSeries) {\n                        title = recurrenceMessages.resetSeriesWindowTitle;\n                        text = recurrenceMessages.resetSeriesConfirmation ? recurrenceMessages.resetSeriesConfirmation : RESETSERIESCONFIRM;\n                    }\n                }\n\n                var buttons = [\n                    { name: \"destroy\", text: isResetSeries ? messages.resetSeries : messages.destroy, click: function() { callback(); } }\n                ];\n\n                if (!(this._isMobile() && kendo.Pane)) {\n                    buttons.push({ name: \"canceledit\", text: messages.cancel, click: function() { callback(true); } });\n                }\n\n                this._unbindResize();\n\n                this.showDialog({\n                    model: model,\n                    text: text,\n                    title: title,\n                    buttons: buttons\n                });\n\n                this._bindResize();\n            } else {\n                callback();\n            }\n        },\n\n        addEvent: function(eventInfo) {\n            var editable = this._editor.editable;\n            var dataSource = this.dataSource;\n            var event;\n\n            eventInfo = eventInfo || {};\n\n            var prevented = this.trigger(\"add\", { event: eventInfo });\n\n            if (!prevented && ((editable && editable.end()) || !editable)) {\n                this.cancelEvent();\n\n                if (eventInfo && eventInfo.toJSON) {\n                    eventInfo = eventInfo.toJSON();\n                }\n\n                event = dataSource.add(eventInfo);\n\n                if (event) {\n                    this.cancelEvent();\n                    this._editEvent(event);\n                }\n            }\n       },\n\n       saveEvent: function() {\n            var that = this;\n            var editor = that._editor;\n            var dataSource = that.dataSource;\n\n            if (!editor) {\n                return;\n            }\n\n            var editable = editor.editable;\n            var container = editor.container;\n            var model = that._modelForContainer(container);\n            var events, i, event;\n\n            if (container && editable && editable.end() &&\n                !that.trigger(SAVE, { container: container, event: model } )) {\n\n                if (!model.isOccurrence() && !!model.recurrenceException && !model.recurrenceRule) {\n                    events = dataSource.data();\n\n                    for (i = events.length - 1; i >= 0; i -= 1) {\n                        event = events[i];\n                        if (event && event.recurrenceId === model.id) {\n                            dataSource.remove(event);\n                        }\n                    }\n\n                    model.set(\"recurrenceException\", \"\");\n                }\n\n                if (!model.dirty && !model.isOccurrence()) {\n                    that._convertDates(model, \"remove\");\n                }\n\n                dataSource.sync();\n            }\n        },\n\n        cancelEvent: function() {\n            var editor = this._editor;\n            var container = editor.container;\n            var model;\n\n            if (container) {\n                model = this._modelForContainer(container);\n\n                if (model && model.isOccurrence()) {\n                    this._convertDates(model, \"remove\");\n                    this._convertDates(this.dataSource.get(model.recurrenceId), \"remove\");\n                }\n\n                this.dataSource.cancelChanges(model);\n\n                //TODO: handle the cancel in UI\n\n                editor.close();\n            }\n        },\n\n        editEvent: function(uid) {\n            var model = typeof uid == \"string\" ? this.occurrenceByUid(uid) : uid;\n\n            if (!model) {\n                return;\n            }\n\n            this.cancelEvent();\n\n            if (model.isRecurring()) {\n                this._editRecurringDialog(model);\n            } else {\n                this._editEvent(model);\n            }\n        },\n\n        _editEvent: function(model) {\n            this._preventRefresh = true;\n            this._unbindResize();\n\n            this._createPopupEditor(model);\n            this.toolbar.find(\".\" + FOCUSEDSTATE).removeClass(FOCUSEDSTATE);\n\n            this._bindResize();\n        },\n\n        _editRecurringDialog: function(model) {\n            var that = this;\n\n            var editOccurrence = function() {\n                if (model.isException()) {\n                    that._editEvent(model);\n                } else {\n                    that.addEvent(model);\n                }\n            };\n\n            var editSeries = function() {\n                if (model.recurrenceId) {\n                    model = that.dataSource.get(model.recurrenceId);\n                }\n\n                that._editEvent(model);\n            };\n\n            var recurrenceMessages = that.options.messages.recurrenceMessages;\n            that._showRecurringDialog(model, editOccurrence, editSeries, {\n                title: recurrenceMessages.editWindowTitle,\n                text: recurrenceMessages.editRecurring ? recurrenceMessages.editRecurring : EDITRECURRING,\n                occurrenceText: recurrenceMessages.editWindowOccurrence,\n                seriesText: recurrenceMessages.editWindowSeries\n            });\n         },\n\n         _showRecurringDialog: function(model, editOccurrence, editSeries, messages) {\n             var editable = this.options.editable;\n             var editRecurringMode = isPlainObject(editable) ? editable.editRecurringMode : \"dialog\";\n\n             if (editRecurringMode === \"occurrence\" || this._isMultiDrag) {\n                 editOccurrence();\n             } else if (editRecurringMode === \"series\") {\n                 editSeries();\n             } else {\n                 this._unbindResize();\n\n                 this.showDialog({\n                     model: model,\n                     title: messages.title,\n                     text: messages.text,\n                     buttons: [\n                         { text: messages.occurrenceText, click: editOccurrence },\n                         { text: messages.seriesText, click: editSeries }\n                     ]\n                 });\n\n                 this._bindResize();\n             }\n        },\n\n        _createButton: function(command) {\n            var template = command.template || COMMANDBUTTONTMPL,\n                commandName = typeof command === STRING ? command : command.name || command.text,\n                options = { className: \"k-scheduler-\" + (commandName || \"\").replace(/\\s/g, \"\"), text: commandName, attr: \"\" };\n\n            if (!commandName && !(isPlainObject(command) && command.template)) {\n                throw new Error(\"Custom commands should have name specified\");\n            }\n\n            if (isPlainObject(command)) {\n                if (command.className) {\n                    command.className += \" \" + options.className;\n                }\n\n                if (commandName === \"edit\" && isPlainObject(command.text)) {\n                    command = extend(true, {}, command);\n                    command.text = command.text.edit;\n                }\n\n                options = extend(true, options, defaultCommands[commandName], command);\n            } else {\n                options = extend(true, options, defaultCommands[commandName]);\n            }\n\n            if (!options.className) {\n                options.className = \"k-button-solid-base\";\n            } else if (options.className.indexOf(\"k-button-solid-primary\") === -1) {\n                options.className += \" k-button-solid-base\";\n            }\n\n            return kendo.template(template)(options);\n        },\n\n        _convertDates: function(model, method) {\n            var timezone = this.dataSource.reader.timezone;\n            var startTimezone = model.startTimezone;\n            var endTimezone = model.endTimezone;\n            var start = model.start;\n            var end = model.start;\n\n            method = method || \"apply\";\n            startTimezone = startTimezone || endTimezone;\n            endTimezone = endTimezone || startTimezone;\n\n            if (startTimezone) {\n                if (timezone) {\n                    if (method === \"apply\") {\n                        start = kendo.timezone.convert(model.start, timezone, startTimezone);\n                        end = kendo.timezone.convert(model.end, timezone, endTimezone);\n                    } else {\n                        start = kendo.timezone.convert(model.start, startTimezone, timezone);\n                        end = kendo.timezone.convert(model.end, endTimezone, timezone);\n                    }\n                } else {\n                    start = kendo.timezone[method](model.start, startTimezone);\n                    end = kendo.timezone[method](model.end, endTimezone);\n                }\n\n                model._set(\"start\", start);\n                model._set(\"end\", end);\n            }\n        },\n\n        _createEditor: function() {\n            var that = this;\n\n            var editor;\n\n            if (this._isMobile() && kendo.Pane) {\n                editor = that._editor = new MobileEditor(this.wrapper, extend({}, this.options, {\n                    target: this,\n                    timezone: that.dataSource.reader.timezone,\n                    resources: that.resources,\n                    createButton: this._createButton.bind(this)\n                }));\n            } else {\n                editor = that._editor = new PopupEditor(this.wrapper, extend({}, this.options, {\n                    target: this,\n                    createButton: this._createButton.bind(this),\n                    timezone: that.dataSource.reader.timezone,\n                    resources: that.resources\n                }));\n            }\n\n            editor.bind(\"cancel\", function(e) {\n                if (that.trigger(\"cancel\", { container: e.container, event: e.model })) {\n                    e.preventDefault();\n                    return;\n                }\n                that._preventRefresh = false;\n                that.cancelEvent();\n\n                if (that._attemptRefresh) {\n                    that.refresh();\n                }\n\n                that.focus();\n            });\n\n            editor.bind(\"edit\", function(e) {\n                if (that.trigger(EDIT, { container: e.container, event: e.model })) {\n                    e.preventDefault();\n                }\n            });\n\n            editor.bind(\"save\", function() {\n                that._preventRefresh = false;\n                that.saveEvent();\n            });\n\n            editor.bind(\"remove\", function(e) {\n                that._preventRefresh = false;\n                that.removeEvent(e.model);\n            });\n\n            editor.bind(\"resetSeries\", function(e) {\n                that._confirmation(function(cancel) {\n                    that._preventRefresh = false;\n                    if (!cancel) {\n                        that.dataSource._removeExceptions(e.model);\n                        that.saveEvent();\n                    }\n                }, e.model, true);\n            });\n        },\n\n        _createPopupEditor: function(model) {\n            var editor = this._editor;\n\n            if (!model.isNew() || model.isOccurrence()) {\n                if (model.isOccurrence()) {\n                    this._convertDates(model.recurrenceId ? this.dataSource.get(model.recurrenceId) : model);\n                }\n                this._convertDates(model);\n            }\n\n            this.editable = editor.editEvent(model);\n        },\n\n        removeEvent: function(uid) {\n            var that = this,\n                model = typeof uid == \"string\" ? that.occurrenceByUid(uid) : uid;\n\n            if (!model) {\n                return;\n            }\n\n            if (model.isRecurring()) {\n                that._deleteRecurringDialog(model);\n            } else {\n                that._confirmation(function(cancel) {\n                    if (!cancel) {\n                        that._removeEvent(model);\n                    }\n                }, model);\n            }\n        },\n\n        occurrenceByUid: function(uid) {\n            var occurrence = this.dataSource.getByUid(uid);\n            if (!occurrence) {\n                occurrence = getOccurrenceByUid(this._data, uid);\n            }\n\n            return occurrence;\n        },\n\n        occurrencesInRange: function(start, end) {\n            return new kendo.data.Query(this._data).filter({\n                logic: \"or\",\n                filters: [\n                    {\n                        logic: \"and\",\n                        filters: [\n                            { field: \"start\", operator: \"gte\", value: start },\n                            { field: \"end\", operator: \"gte\", value: start },\n                            { field: \"start\", operator: \"lt\", value: end }\n                        ]\n                    },\n                    {\n                        logic: \"and\",\n                        filters: [\n                            { field: \"start\", operator: \"lte\", value: start },\n                            { field: \"end\", operator: \"gt\", value: start }\n                        ]\n                    }\n                ]\n            }).toArray();\n        },\n\n        _removeEvent: function(model) {\n            if (!this.trigger(REMOVE, { event: model })) {\n                if (this.dataSource.remove(model)) {\n                    this.dataSource.sync();\n                }\n            }\n        },\n\n        _deleteRecurringDialog: function(model) {\n            var that = this;\n            var currentModel = model;\n            var editable = that.options.editable;\n            var deleteOccurrence;\n            var deleteSeries;\n            var createException;\n            var deleteOccurrenceConfirmation;\n            var deleteSeriesConfirmation;\n            var createExceptionConfirmation;\n            var editRecurringMode = isPlainObject(editable) ? editable.editRecurringMode : \"dialog\";\n\n            deleteOccurrence = function() {\n                var occurrence = currentModel.recurrenceId ? currentModel : currentModel.toOccurrence();\n                var head = that.dataSource.get(occurrence.recurrenceId);\n\n                that._convertDates(head);\n                that._removeEvent(occurrence);\n            };\n\n            deleteSeries = function() {\n                if (currentModel.recurrenceId) {\n                    currentModel = that.dataSource.get(currentModel.recurrenceId);\n                }\n\n                that._removeEvent(currentModel);\n            };\n\n            createException = function() {\n                that.dataSource.remove(currentModel);\n                that.dataSource.sync();\n            };\n\n            if (editRecurringMode != \"dialog\" || that._isEditorOpened()) {\n                deleteOccurrenceConfirmation = function() {\n                    that._confirmation(function(cancel) {\n                        if (!cancel) {\n                            deleteOccurrence();\n                        }\n                    }, currentModel);\n                };\n\n                deleteSeriesConfirmation = function() {\n                    that._confirmation(function(cancel) {\n                        if (!cancel) {\n                            deleteSeries();\n                        }\n                    }, currentModel);\n                };\n\n                createExceptionConfirmation = function() {\n                    that._confirmation(function(cancel) {\n                        if (!cancel) {\n                            createException();\n                        }\n                    }, currentModel);\n                };\n            }\n\n            var seriesCallback = deleteSeriesConfirmation || deleteSeries;\n            var occurrenceCallback = deleteOccurrenceConfirmation || deleteOccurrence;\n            var exeptionCallback = createExceptionConfirmation || createException;\n\n            if (that._isEditorOpened()) {\n                if (model.isException()) {\n                    occurrenceCallback();\n                } else if (model.isNew()) {\n                    exeptionCallback();\n                } else {\n                    seriesCallback();\n                }\n            } else {\n                var recurrenceMessages = that.options.messages.recurrenceMessages;\n                that._showRecurringDialog(model, occurrenceCallback, seriesCallback, {\n                    title: recurrenceMessages.deleteWindowTitle,\n                    text: recurrenceMessages.deleteRecurring ? recurrenceMessages.deleteRecurring : DELETERECURRING,\n                    occurrenceText: recurrenceMessages.deleteWindowOccurrence,\n                    seriesText: recurrenceMessages.deleteWindowSeries\n                });\n            }\n        },\n\n        _isEditorOpened: function() {\n            return !!this._editor.container;\n        },\n\n        _unbindView: function(view) {\n            var that = this;\n            that.angular(\"cleanup\", function() {\n                return { elements: that.items() };\n            });\n\n            view.destroy();\n        },\n\n        _bindView: function(view) {\n            var that = this;\n\n            if (that.options.editable) {\n                if (that._viewRemoveHandler) {\n                    view.unbind(REMOVE, that._viewRemoveHandler);\n                }\n\n                that._viewRemoveHandler = function(e) {\n                    that.removeEvent(e.uid);\n                };\n\n                view.bind(REMOVE, that._viewRemoveHandler);\n\n                if (that._viewAddHandler) {\n                    view.unbind(ADD, that._viewAddHandler);\n                }\n\n                that._viewAddHandler = function(e) {\n                    that.addEvent(e.eventInfo);\n                };\n\n                view.bind(ADD, this._viewAddHandler);\n\n                if (that._viewEditHandler) {\n                    view.unbind(EDIT, that._viewEditHandler);\n                }\n\n                that._viewEditHandler = function(e) {\n                    that.editEvent(e.uid);\n                };\n\n                view.bind(EDIT, this._viewEditHandler);\n            }\n\n            if (that._viewNavigateHandler) {\n                view.unbind(\"navigate\", that._viewNavigateHandler);\n            }\n\n            that._viewNavigateHandler = function(e) {\n                if (e.action) {\n                    if (!that.trigger(\"navigate\", { view: e.view, isWorkDay: e.isWorkDay, action: e.action, date: e.date })) {\n                        that.date(e.date);\n                    }\n                } else if (e.view) {\n                    var switchWorkDay = \"isWorkDay\" in e;\n                    var action = switchWorkDay ? \"changeWorkDay\" : \"changeView\";\n\n                    if (!that.trigger(\"navigate\", { view: e.view, isWorkDay: e.isWorkDay, action: action, date: e.date })) {\n                        if (switchWorkDay) {\n                            that._workDayMode = e.isWorkDay;\n                        }\n\n                        that._selectView(e.view);\n                        that.date(e.date);\n                    }\n                }\n            };\n\n            view.bind(\"navigate\", that._viewNavigateHandler);\n\n            if (that._viewActivateHandler) {\n                view.unbind(\"activate\", that._viewActivateHandler);\n            }\n\n            that._viewActivateHandler = function() {\n                var view = this;\n                if (that._selection) {\n                    view.constrainSelection(that._selection);\n\n                    if ($(document.activeElement).closest(\".k-scheduler-toolbar\").length === 0) {\n                        if (document.activeElement !== that.wrapper[0]) {\n                            that.element.focus();\n                        } else {\n                            that._select();\n                        }\n                    }\n\n                    that._adjustSelectedDate();\n                }\n            };\n\n            view.bind(\"activate\", that._viewActivateHandler);\n        },\n\n        _selectView: function(name) {\n            var that = this;\n\n            if (name && that.views[name]) {\n\n                if (that._selectedView) {\n                    that._unbindView(that._selectedView);\n                }\n\n                that._selectedView = that._renderView(name);\n                that._selectedViewName = name;\n\n                if (that._viewsCount > 1 && !that._isMobile()) {\n                    var viewsDropdown = that.toolbar.find(\".k-views-dropdown\");\n                    var viewButtons = that.toolbar.find(\".k-scheduler-views > .k-button\");\n\n                    if ( that.toolbar.find(\".k-views-dropdown\").length === 0 ) {\n                        that.toolbar.find(\".k-scheduler-views-wrapper\").prepend(VIEWS_DROPDOWN_TEMPLATE({ views: that.views, view: name, ns: kendo.ns, label: that.options.messages.selectView }));\n                        viewsDropdown = that.toolbar.find(\".k-views-dropdown\");\n                    }\n\n                    viewsDropdown.val(name);\n\n                    viewButtons.removeClass(\"k-selected\");\n                    viewButtons.filter(\".k-view-\" + name.replace(/\\./g, \"\\\\.\").toLowerCase()).addClass(\"k-selected\");\n                } else {\n                    var viewSelect = that.toolbar.find(\".k-scheduler-mobile-views\");\n\n                    viewSelect.find(\"[value=\" + name.replace(/\\./g, \"\\\\.\") + \"]\")\n                        .prop(\"selected\", \"selected\");\n                }\n            }\n        },\n\n        view: function(name) {\n            var that = this;\n\n            if (name) {\n                that._selectView(name);\n                that.rebind();\n\n                return;\n            }\n\n            return that._selectedView;\n        },\n\n        viewName: function() {\n            return this.view().name;\n        },\n\n        _renderView: function(name) {\n            var view = this._initializeView(name);\n\n            this._bindView(view);\n\n            if (kendo.support.mouseAndTouchPresent || kendo.support.pointers) {\n                view.content.css(\"-ms-touch-action\", \"pinch-zoom\");\n                view.content.css(\"touch-action\", \"pinch-zoom\");\n            }\n\n            this._model.set(\"formattedDate\", view.dateForTitle());\n            this._model.set(\"formattedShortDate\", view.shortDateForTitle());\n            this._model.set(\"formattedMobileDate\", view.mobileDateForTitle ? view.mobileDateForTitle() : view.shortDateForTitle());\n            this._model.set(\"formattedYear\", kendo.format(\"{0:yyyy}\", view.startDate()));\n\n            return view;\n        },\n\n        resize: function(force) {\n            var size = this.getSize();\n            var currentSize = this._size;\n            var view = this.view();\n\n            if (!view || !view.groups) {\n                return;\n            }\n\n            if (force || !currentSize || size.width !== currentSize.width || size.height !== currentSize.height) {\n                this.refresh({ action: \"resize\" });\n                this._size = size;\n            }\n        },\n\n        _adjustSelectedDate: function() {\n            var date = this._model.selectedDate,\n                selection = this._selection,\n                start = selection.start;\n\n            if (start && !kendo.date.isInDateRange(date, getDate(start), getDate(selection.end))) {\n                date.setFullYear(start.getFullYear(), start.getMonth(), start.getDate());\n            }\n        },\n\n        _initializeView: function(name) {\n            var view = this.views[name];\n\n            if (view) {\n                var isSettings = isPlainObject(view),\n                    overrideOptions = {},\n                    type = view.type;\n\n                if (typeof type === STRING) {\n                    type = kendo.getter(view.type)(window);\n                }\n\n                if (isSettings && view.workDays && view.workDays.length) {\n                    overrideOptions.workDays = view.workDays;\n                }\n\n                if (type) {\n                    view = new type(this.wrapper, trimOptions(extend(true, {}, this.options, isSettings ? view : {}, {\n                        resources: this.resources,\n                        date: this.date(),\n                        startTime: kendo.parseDate(view.startTime) || kendo.parseDate(this.options.startTime),\n                        endTime: kendo.parseDate(view.endTime) || kendo.parseDate(this.options.endTime),\n                        showWorkHours: this._workDayMode\n                    }),overrideOptions));\n\n                } else {\n                    throw new Error(\"There is no such view\");\n                }\n            }\n\n            return view;\n        },\n\n        _views: function() {\n            var views = this.options.views;\n            var view;\n            var defaultView;\n            var selected;\n            var isSettings;\n            var name;\n            var type;\n            var idx;\n            var length;\n\n            this.views = {};\n            this._viewsCount = 0;\n\n            for (idx = 0, length = views.length; idx < length; idx++) {\n                var hasType = false;\n\n                view = views[idx];\n\n                isSettings = isPlainObject(view);\n\n                if (isSettings) {\n                    type = name = view.type ? view.type : view;\n                    if (typeof type !== STRING) {\n                        name = view.name || view.title;\n                        hasType = true;\n                    }\n                } else {\n                    type = name = view;\n                }\n\n                defaultView = defaultViews[name];\n\n                if (defaultView && !hasType) {\n\n                    view.type = defaultView.type;\n                    defaultView.title = this.options.messages.views[name];\n                    if (defaultView.type === \"day\") {\n                        defaultView.messages = { allDay: this.options.messages.allDay };\n                    } else if (defaultView.type === \"agenda\") {\n                        defaultView.messages = {\n                            event: this.options.messages.event,\n                            date: this.options.messages.date,\n                            time: this.options.messages.time\n                        };\n                    }\n                }\n\n                view = extend({ title: name }, defaultView, isSettings ? view : {});\n\n                if (name) {\n                    this.views[name] = view;\n                    this._viewsCount++;\n\n                    if (!selected || view.selected) {\n                        selected = name;\n                    }\n                }\n            }\n\n            if (selected) {\n                this._selectedViewName = selected; // toolbar is not rendered yet\n            }\n        },\n\n        rebind: function() {\n            var that = this,\n                resources = that.resources,\n                resourceFetchArray = [];\n\n            if (that._preventRebind) {\n                that._preventRebind = false;\n                return;\n            }\n\n            if (that.options.autoBind === false && resources && resources.length > 0) {\n                resources.forEach(function(resource) {\n                    if (resource.dataSource.data().length === 0) {\n                        that._preventRebind = true;\n                        resourceFetchArray.push(resource.dataSource.fetch());\n                    }\n                });\n\n                $.when.apply(null, resourceFetchArray).then(function() {\n                    that.dataSource.fetch();\n                    that._preventRebind = false;\n                });\n            } else {\n                that.dataSource.fetch();\n            }\n        },\n\n        _dataSource: function() {\n            var that = this,\n                options = that.options,\n                dataSource = options.dataSource;\n\n            dataSource = isArray(dataSource) ? { data: dataSource } : dataSource;\n\n            if (options.timezone && !(dataSource instanceof SchedulerDataSource)) {\n                dataSource = extend(true, dataSource, { schema: { timezone: options.timezone } });\n            } else if (dataSource instanceof SchedulerDataSource) {\n                options.timezone = dataSource.options.schema ? dataSource.options.schema.timezone : \"\";\n            }\n\n            if (that.dataSource && that._refreshHandler) {\n                that.dataSource\n                    .unbind(CHANGE, that._refreshHandler)\n                    .unbind(PROGRESS, that._progressHandler)\n                    .unbind(ERROR, that._errorHandler);\n            } else {\n                that._refreshHandler = that.refresh.bind(that);\n                that._progressHandler = that._requestStart.bind(that);\n                that._errorHandler = that._error.bind(that);\n            }\n\n            that.dataSource = kendo.data.SchedulerDataSource.create(dataSource)\n                .bind(CHANGE, that._refreshHandler)\n                .bind(PROGRESS, that._progressHandler)\n                .bind(ERROR, that._errorHandler);\n\n            that.options.dataSource = that.dataSource;\n        },\n\n\n        _error: function() {\n            this._progress(false);\n        },\n\n        _requestStart: function() {\n            this._progress(true);\n        },\n\n        _progress: function(toggle) {\n            var element = this.element.find(\".k-scheduler-content\");\n            kendo.ui.progress(element, toggle);\n        },\n\n        _resources: function() {\n            var that = this;\n            var resources = that.options.resources;\n            var resourcePromises = [];\n\n            for (var idx = 0; idx < resources.length; idx++) {\n                var resource = resources[idx];\n                var field = resource.field;\n                var name = resource.name || field;\n                var dataSource = resource.dataSource;\n\n                if (!field || !dataSource) {\n                    throw new Error('The \"field\" and \"dataSource\" options of the scheduler resource are mandatory.');\n                }\n\n                that.resources.push({\n                    field: field,\n                    name: name,\n                    title: resource.title || field,\n                    dataTextField: resource.dataTextField || \"text\",\n                    dataValueField: resource.dataValueField || \"value\",\n                    dataColorField: resource.dataColorField || \"color\",\n                    dataParentValueField: resource.dataParentValueField || \"parentValue\",\n                    valuePrimitive: resource.valuePrimitive != null ? resource.valuePrimitive : true,\n                    multiple: resource.multiple || false,\n                    dataSource: that._resourceDataSource(dataSource, name, resourcePromises)\n                });\n            }\n\n            if (!that.options.autoBind) {\n                that._selectView(that._selectedViewName);\n            } else {\n                $.when.apply(null, resourcePromises)\n                      .then(function() {\n                            that.view(that._selectedViewName);\n                        });\n            }\n        },\n\n        _resourceDataSource: function(resourceDS, groupName, promises) {\n            var that = this;\n            var dataSource = isArray(resourceDS) ? { data: resourceDS } : resourceDS;\n            var dataSourceInstance = kendo.data.DataSource.create(dataSource);\n\n            if (that.options.autoBind) {\n                promises.push(dataSourceInstance.fetch(function() {\n                    // 'this' is the DataSource instance not the Scheduler\n                    that._bindResourceEvents(this, groupName);\n                }));\n            } else {\n                that._bindResourceEvents(dataSourceInstance, groupName);\n            }\n\n            return dataSourceInstance;\n        },\n\n        _bindResourceEvents: function(resourceDS, groupName) {\n            var that = this;\n            var isGrouped = that.options.group && that.options.group.resources.length;\n            var isResourceGrouped = isGrouped && that.options.group.resources.indexOf(groupName) > -1;\n\n            if (!that._resourceRefreshHandler && isResourceGrouped) {\n                that._resourceRefreshHandler = that._refreshResource.bind(that);\n                that._resourceErrorHandler = that._error.bind(that);\n            }\n\n            if (isResourceGrouped) {\n                resourceDS.bind(CHANGE, that._resourceRefreshHandler)\n                    .bind(ERROR, that._resourceErrorHandler);\n            }\n        },\n\n        _refreshResource: function() {\n            var that = this;\n            var preventRefresh = (that._editor && that._editor.editable) || that._preventRefresh;\n\n            if (!preventRefresh) {\n                that.view(that._selectedViewName);\n            }\n        },\n\n        _initModel: function() {\n            var that = this;\n            that._model = kendo.observable({\n               selectedDate: new Date(this.options.date),\n               formattedDate: \"\",\n               formattedShortDate: \"\"\n           });\n\n           that._model.bind(CHANGE, function(e) {\n                if (e.field === \"selectedDate\") {\n                    that.view(that._selectedViewName);\n                }\n           });\n        },\n\n        _wrapper: function() {\n            var that = this;\n            var options = that.options;\n            var height = options.height;\n            var width = options.width;\n\n            that.wrapper = that.element.addClass(\"k-widget k-scheduler k-floatwrap\");\n\n            if (that._isMobile()) {\n               that.wrapper.addClass(\"k-scheduler-mobile\");\n            }\n\n            if (height) {\n                that.wrapper.height(height);\n            }\n\n            if (width) {\n                that.wrapper.width(width);\n            }\n        },\n\n        date: function(value) {\n            if (value != null && getDate(value) >= getDate(this.options.min) && getDate(value) <= getDate(this.options.max)) {\n                this._model.set(\"selectedDate\", value);\n            }\n            return getDate(this._model.get(\"selectedDate\"));\n        },\n\n        _toolbar: function() {\n            var that = this;\n            var options = that.options;\n            var commands = [];\n\n            if (options.toolbar) {\n                commands = Array.isArray(options.toolbar) ? options.toolbar : [options.toolbar];\n            }\n\n            var template = this._isMobile() ? MOBILETOOLBARTEMPLATE : TOOLBARTEMPLATE;\n\n            var toolbar = $(template({\n                    messages: options.messages,\n                    pdf: $.grep(commands, function(item) {\n                            return item == \"pdf\" || item.name == \"pdf\";\n                        }).length > 0,\n                    search: $.grep(commands, function(item) {\n                        return item == \"search\" || item.name == \"search\";\n                    }).length > 0,\n                    ns: kendo.ns,\n                    view: that._selectedViewName,\n                    views: that.views,\n                    viewsCount: that._viewsCount,\n                    editable: that.options.editable\n                }));\n\n            that.wrapper.append(toolbar);\n            that.toolbar = toolbar;\n\n            kendo.bind(that.toolbar, that._model);\n\n            toolbar.on(CLICK + NS, \".k-pdf\", function(e) {\n                e.preventDefault();\n                that.saveAsPDF();\n            });\n\n            toolbar.on(\"input\" + NS, \".k-scheduler-search-input\", kendo.throttle(function(e) {\n                that.dataSource.filter({\n                    logic: \"or\",\n                    filters: [\n                        { field: \"title\", operator: \"contains\", value: e.target.value },\n                        { field: \"description\", operator: \"contains\", value: e.target.value }\n                    ]\n                });\n            }, 250));\n\n            toolbar.on(CLICK + NS, \".k-create-event\", function(e) {\n                e.preventDefault();\n                that.addEvent();\n            });\n\n            toolbar.on(CLICK + NS, \".k-nav-calendar\", function(e) {\n                e.preventDefault();\n                that._showCalendar(e.target);\n            });\n\n            toolbar.on(CLICK + NS, \".k-scheduler-navigation > .k-button\", function(e) {\n                var button = $(this);\n                var date = new Date(that.date());\n                var action = \"\";\n                var currentDate = new Date();\n                var timezone = that.options.timezone;\n\n                that.toolbar.find(\".\" + FOCUSEDSTATE).removeClass(FOCUSEDSTATE);\n                button.addClass(FOCUSEDSTATE).attr(\"tabindex\", 0).trigger(\"focus\").attr(\"tabindex\", -1);\n\n                if ($(e.target).is(\"input\")) {\n                    return;\n                }\n\n                e.preventDefault();\n\n                if (button.hasClass(\"k-nav-today\")) {\n                    action = \"today\";\n                    if (timezone) {\n                        var timezoneOffset = kendo.timezone.offset(currentDate, timezone);\n                        date = kendo.timezone.convert(currentDate, currentDate.getTimezoneOffset(), timezoneOffset);\n                    } else {\n                        date = currentDate;\n                    }\n                } else if (button.hasClass(\"k-nav-next\")) {\n                    action = \"next\";\n                    date = that.view().nextDate();\n                } else if (button.hasClass(\"k-nav-prev\")) {\n                    action = \"previous\";\n                    date = that.view().previousDate();\n                }\n\n                if (!that.trigger(\"navigate\", { view: that._selectedViewName, action: action, date: date })) {\n                    that.date(date);\n                }\n            });\n\n            toolbar.on(CLICK + NS, \".k-nav-current\", function(e) {\n                e.preventDefault();\n\n                that.toolbar.find(\".\" + FOCUSEDSTATE).removeClass(FOCUSEDSTATE);\n                $(this).addClass(FOCUSEDSTATE);\n\n                if (!that._isMobile()) {\n                    that._showCalendar();\n                }\n            });\n\n            toolbar.on(CLICK + NS, \".k-scheduler-views > .k-button, .k-scheduler-refresh\", function(e) {\n                e.preventDefault();\n\n                var name = $(this).attr(kendo.attr(\"name\"));\n\n                that.toolbar.find(\".\" + FOCUSEDSTATE).removeClass(FOCUSEDSTATE);\n                $(this).addClass(FOCUSEDSTATE).attr(\"tabindex\", 0).trigger(\"focus\").attr(\"tabindex\", -1);\n\n                if (!that.trigger(\"navigate\", { view: name, action: \"changeView\", date: that.date() })) {\n                    that.view(name);\n                }\n            });\n\n            toolbar.on(CHANGE + NS, \".k-views-dropdown, .k-scheduler-mobile-views\", function() {\n                var name = this.value;\n\n                if (!that.trigger(\"navigate\", { view: name, action: \"changeView\", date: that.date() })) {\n                    that.view(name);\n                }\n            });\n        },\n\n        _showCalendar: function(targetElm) {\n            var that = this,\n                target = targetElm || that.toolbar.find(\".k-nav-current\"),\n                html = $('<div class=\"k-calendar-container\"><div class=\"k-scheduler-calendar\"></div></div>');\n\n            if (!that.popup) {\n                that.popup = new Popup(html, {\n                    anchor: target,\n                    activate: function() {\n                        if (that.popup && that.calendar) {\n                            that.popup._toggleResize(false);\n                            that.calendar.element.find(\"table\").trigger(\"focus\");\n                            that.popup._toggleResize(true);\n                        }\n                    },\n                    open: function() {\n                        if (!that.calendar) {\n                            that.calendar = new Calendar(this.element.find(\".k-scheduler-calendar\"),\n                            {\n                                change: function() {\n                                    var date = this.value();\n                                    if (!that.trigger(\"navigate\", { view: that._selectedViewName, action: \"changeDate\", date: date })) {\n                                        that.date(date);\n                                        that.popup.close();\n                                    }\n\n                                    if (!that._isMobile()) {\n                                        that._selectedView.element.trigger(\"focus\");\n                                        that.toolbar.find(\".k-nav-current\").trigger(\"focus\").addClass(FOCUSEDSTATE);\n                                    }\n                                },\n                                min: that.options.min,\n                                max: that.options.max\n                            });\n                        }\n                        that.calendar.element.on(\"keydown\" + NS, function(e) {\n                            if (e.keyCode === keys.ESC || e.keyCode === keys.TAB) {\n                                that.popup.close();\n                                that._selectedView.element.trigger(\"focus\");\n                                that.toolbar.find(\".k-nav-current\").trigger(\"focus\").addClass(FOCUSEDSTATE);\n                            }\n                        });\n\n                        that.calendar.setOptions({\n                            start: that._selectedViewName === \"year\" ? \"decade\" : \"month\",\n                            depth: that._selectedViewName === \"year\" ? \"decade\" : \"month\"\n                        });\n\n                        that.calendar.value(that.date());\n                    },\n                    copyAnchorStyles: false\n                });\n            }\n\n            that.popup.open();\n        },\n\n        refresh: function(e) {\n            var that = this;\n            var view = this.view();\n            var preventRefresh = (e && e.action === \"itemchange\" && (this._editor.editable || this._preventRefresh)) ||\n                                 (this.dataSource.options.type === \"signalr\" && this._preventRefresh);\n\n            this._progress(false);\n\n            this.angular(\"cleanup\", function() {\n                return { elements: that.items() };\n            });\n\n            e = e || {};\n\n            if (!view) {\n                return;\n            }\n\n            if (preventRefresh) { // skip rebinding if editing is in progress\n                this._attemptRefresh = true && this.dataSource.options.type === \"signalr\";\n                return;\n            }\n\n            if (this.trigger(\"dataBinding\", { action: e.action || \"rebind\", index: e.index, items: e.items })) {\n                return;\n            }\n\n            if (!(e && e.action === \"resize\") && this._editor) {\n                this._editor.close();\n            }\n\n            this._data = this.dataSource.expand(view.startDate(), view.visibleEndDate());\n\n            view.refreshLayout();\n\n            view.render(this._data);\n\n            this.trigger(\"dataBound\");\n            this._attemptRefresh = false;\n        },\n\n        slotByPosition: function(x, y) {\n            var view = this.view();\n\n            if (!view._slotByPosition) {\n                return null;\n            }\n\n            var slot = view._slotByPosition(x, y);\n\n            if (!slot) {\n                return null;\n            }\n\n            return {\n                startDate: slot.startDate(),\n                endDate: slot.endDate(),\n                groupIndex: slot.groupIndex,\n                element: slot.element,\n                isDaySlot: slot.isDaySlot\n            };\n        },\n\n        slotByElement: function(element) {\n            var offset = $(element).offset();\n            return this.slotByPosition(offset.left, offset.top);\n        },\n\n        resourcesBySlot: function(slot) {\n            return this.view()._resourceBySlot(slot);\n        }\n    });\n\n    var defaultViews = {\n        day: {\n            type: \"kendo.ui.DayView\"\n        },\n        week: {\n            type: \"kendo.ui.WeekView\"\n        },\n        workWeek: {\n            type: \"kendo.ui.WorkWeekView\"\n        },\n        agenda: {\n            type: \"kendo.ui.AgendaView\"\n        },\n        month: {\n            type: \"kendo.ui.MonthView\"\n        },\n        timeline: {\n            type: \"kendo.ui.TimelineView\"\n        },\n        timelineWeek: {\n            type: \"kendo.ui.TimelineWeekView\"\n        },\n        timelineWorkWeek: {\n            type: \"kendo.ui.TimelineWorkWeekView\"\n        },\n        timelineMonth: {\n            type: \"kendo.ui.TimelineMonthView\"\n        },\n        year: {\n            type: \"kendo.ui.YearView\"\n        }\n    };\n\n    ui.plugin(Scheduler);\n\n    if (kendo.PDFMixin) {\n        kendo.PDFMixin.extend(Scheduler.prototype);\n\n        var SCHEDULER_EXPORT = \"k-scheduler-pdf-export\";\n        Scheduler.fn._drawPDF = function(progress) {\n            var wrapper = this.wrapper;\n            var styles = wrapper[0].style.cssText;\n\n            wrapper.css({\n                width: wrapper.width(),\n                height: wrapper.height()\n            });\n\n            wrapper.addClass(SCHEDULER_EXPORT);\n\n            var scheduler = this;\n            var promise = new $.Deferred();\n            var table = wrapper.find(\".k-scheduler-content\").find(\"table\").css(\"table-layout\", \"auto\");\n\n            setTimeout(function() {\n                table.css(\"table-layout\", \"fixed\");\n                scheduler.resize(true);\n\n                scheduler._drawPDFShadow({}, {\n                    avoidLinks: scheduler.options.pdf.avoidLinks\n                })\n                .done(function(group) {\n                    var args = {\n                        page: group,\n                        pageNumber: 1,\n                        progress: 1,\n                        totalPages: 1\n                    };\n\n                    progress.notify(args);\n                    promise.resolve(args.page);\n                })\n                .fail(function(err) {\n                    promise.reject(err);\n                })\n                .always(function() {\n                    wrapper[0].style.cssText = styles;\n                    wrapper.removeClass(SCHEDULER_EXPORT);\n                    scheduler.resize(true);\n\n                    //Required because slot.offsetLeft is incorrect after first resize\n                    scheduler.resize(true);\n                });\n            });\n\n            return promise;\n        };\n    }\n\n    var TimezoneEditor = Widget.extend({\n        init: function(element, options) {\n            var that = this,\n                zones = kendo.timezone.windows_zones;\n\n            if (!zones || !kendo.timezone.zones_titles) {\n                throw new Error('kendo.timezones.min.js is not included.');\n            }\n\n            Widget.fn.init.call(that, element, options);\n\n            that.wrapper = that.element;\n\n            that._zonesQuery = new kendo.data.Query(zones);\n            that._zoneTitleId = kendo.guid();\n            that._zoneTitlePicker();\n            that._zonePicker();\n\n            that._zoneTitle.bind(\"cascade\", function() {\n                if (!this.value()) {\n                    that._zone.wrapper.hide();\n                }\n            });\n\n            that._zone.bind(\"cascade\", function() {\n                that._value = this.value();\n                that.trigger(CHANGE);\n            });\n\n            that.value(that.options.value);\n        },\n        options: {\n            name: \"TimezoneEditor\",\n            value: \"\",\n            optionLabel: \"No timezone\"\n        },\n        events: [ CHANGE ],\n\n        _zoneTitlePicker: function() {\n            var that = this,\n                zoneTitle = $('<input id=\"' + that._zoneTitleId + '\" aria-label=\"' + that.options.title + '\"/>').appendTo(that.wrapper);\n\n            that._zoneTitle = new kendo.ui.DropDownList(zoneTitle, {\n                dataSource: kendo.timezone.zones_titles,\n                dataValueField: \"other_zone\",\n                dataTextField: \"name\",\n                optionLabel: that.options.optionLabel\n            });\n        },\n\n        _zonePicker: function() {\n            var that = this,\n                zone = $('<input aria-label=\"' + that.options.title + '\"/>').appendTo(this.wrapper);\n\n            that._zone = new kendo.ui.DropDownList(zone, {\n                dataValueField: \"zone\",\n                dataTextField: \"territory\",\n                dataSource: that._zonesQuery.data,\n                cascadeFrom: that._zoneTitleId,\n                dataBound: function() {\n                    that._value = this.value();\n                    this.wrapper.toggle(this.dataSource.view().length > 1);\n                }\n            });\n\n            that._zone.wrapper.hide();\n        },\n\n        destroy: function() {\n            Widget.fn.destroy.call(this);\n\n            kendo.destroy(this.wrapper);\n        },\n\n        value: function(value) {\n            var that = this,\n                zone;\n\n            if (value === undefined) {\n                return that._value;\n            }\n\n            zone = that._zonesQuery.filter({ field: \"zone\", operator: \"eq\", value: value }).data[0];\n\n            if (zone) {\n                that._zoneTitle.value(zone.other_zone);\n                that._zone.value(zone.zone);\n            } else {\n                that._zoneTitle.select(0);\n            }\n\n        }\n    });\n\n    ui.plugin(TimezoneEditor);\n\n    var ZONETITLEOPTIONTEMPLATE = kendo.template('<option value=\"#=other_zone#\">#=name#</option>');\n    var ZONEOPTIONTEMPLATE = kendo.template('<option value=\"#=zone#\">#=territory#</option>');\n\n    var MobileTimezoneEditor = Widget.extend({\n        init: function(element, options) {\n            var that = this,\n                zones = kendo.timezone.windows_zones;\n\n            if (!zones || !kendo.timezone.zones_titles) {\n                throw new Error('kendo.timezones.min.js is not included.');\n            }\n\n            Widget.fn.init.call(that, element, options);\n\n            that.wrapper = that.element;\n\n            that._zonesQuery = new kendo.data.Query(zones);\n            that._zoneTitlePicker();\n            that._zonePicker();\n\n            that.value(that.options.value);\n        },\n\n        options: {\n            name: \"MobileTimezoneEditor\",\n            optionLabel: \"No timezone\",\n            value: \"\"\n        },\n\n        events: [ CHANGE ],\n\n        _bindZones: function(value) {\n            var data = value ? this._filter(value) : [];\n\n            this._zone.html(this._options(data, ZONEOPTIONTEMPLATE));\n        },\n\n        _filter: function(value) {\n            return this._zonesQuery.filter({ field: \"other_zone\", operator: \"eq\", value: value }).data;\n        },\n\n        _options: function(data, template, optionLabel) {\n            var idx = 0;\n            var html = \"\";\n            var length = data.length;\n\n            if (optionLabel) {\n                html += template({ other_zone: \"\", name: optionLabel });\n            }\n\n            for (; idx < length; idx++) {\n                html += template(data[idx]);\n            }\n\n            return html;\n        },\n\n        _zoneTitlePicker: function() {\n            var that = this;\n            var options = that._options(kendo.timezone.zones_titles, ZONETITLEOPTIONTEMPLATE, that.options.optionLabel);\n\n            that._zoneTitle = $('<select>' + options + '</select>')\n                                .appendTo(that.wrapper)\n                                .on(\"change\", function() {\n                                    var value = this.value;\n                                    var zone = that._zonePickerLabel;\n                                    var zoneSelect = zone.find(\"select\");\n\n                                    that._bindZones(value);\n\n                                    if (value && zoneSelect.children().length > 1) {\n                                        zone.show();\n                                    } else {\n                                        zone.hide();\n                                    }\n\n                                    that._value = that._zone[0].value;\n\n                                    that.trigger(CHANGE);\n                                });\n        },\n\n        _zonePicker: function() {\n            var that = this;\n\n            that._zonePickerLabel = $(\"<li class='k-item k-listgroup-item k-zonepicker' style='display:none'>\" +\n                                        \"<label class='k-label k-listgroup-form-row'>\" +\n                                            \"<span class='k-item-title k-listgroup-form-field-label'></span>\" +\n                                            \"<div class='k-listgroup-form-field-wrapper'></div>\" +\n                                        \"</label>\" +\n                                    \"</li>\");\n\n            that._zone = $('<select></select>')\n                            .appendTo(that._zonePickerLabel.find(\"div\"))\n                            .on(\"change\", function() {\n                                that._value = this.value;\n\n                                that.trigger(CHANGE);\n                            });\n\n            this.wrapper.closest(\".k-item\").after(that._zonePickerLabel);\n\n            that._bindZones(that._zoneTitle.val());\n            that._value = that._zone[0].value;\n        },\n\n        destroy: function() {\n            Widget.fn.destroy.call(this);\n\n            kendo.destroy(this.wrapper);\n        },\n\n        value: function(value) {\n            var that = this;\n            var zonePicker = that._zone;\n            var other_zone = \"\";\n            var zone_value = \"\";\n            var zone;\n\n            if (value === undefined) {\n                return that._value;\n            }\n\n            zone = that._zonesQuery.filter({ field: \"zone\", operator: \"eq\", value: value }).data[0];\n\n            if (zone) {\n                zone_value = zone.zone;\n                other_zone = zone.other_zone;\n            }\n\n            that._zoneTitle.val(other_zone);\n            that._bindZones(other_zone);\n\n            zonePicker.val(zone_value);\n            zone_value = zonePicker[0].value;\n\n            if (zone_value && zonePicker.children.length > 1) {\n                that._zonePickerLabel.show();\n            } else {\n                that._zonePickerLabel.hide();\n            }\n\n            that._value = zone_value;\n        }\n    });\n\n    ui.plugin(MobileTimezoneEditor);\n\n})(window.kendo.jQuery);\n\nreturn window.kendo;\n\n}, typeof define == 'function' && define.amd ? define : function(a1, a2, a3) { (a3 || a2)(); });\n\n"],"names":["define","__meta__","id","name","category","description","depends","features","$","window","kendo","jQuery","undefined","date","MS_PER_DAY","getDate","getMilliseconds","recurrence","keys","extend","F10","ui","Widget","DataBoundWidget","STRING","Popup","Calendar","DataSource","data","isPlainObject","toString","Object","prototype","isArray","Array","NS","CLICK","MOUSEDOWN","TOUCHSTART","support","pointers","TOUCHMOVE","TOUCHEND","MOUSEMOVE","mousemove","CHANGE","PROGRESS","ERROR","CANCEL","REMOVE","RESET","SAVE","ADD","EDIT","DISABLED","OPTION","FOCUSEDSTATE","VIEWSSELECTOR","INVERSECOLORCLASS","valueStartEndBoundRegex","TODAY","Date","EXCEPTION_SEPARATOR","OLD_EXCEPTION_SEPARATOR_REGEXP","RECURRENCE_EXCEPTION","DELETECONFIRM","DELETERECURRING","EDITRECURRING","DELETERECURRINGCONFIRM","RESETSERIESCONFIRM","DELETESERIESCONFIRM","COMMANDBUTTONTMPL","VIEWS_DROPDOWN_TEMPLATE","template","TOOLBARTEMPLATE","MOBILETOOLBARTEMPLATE","MOBILEDATERANGEEDITOR","container","options","attr","field","title","isAllDay","model","dateTimeValidate","dateValidate","appendTimezoneAttr","appendValidDateValidator","appendDateCompareValidator","appendTo","hide","DATERANGEEDITOR","RECURRENCEEDITOR","kendoRecurrenceEditor","start","timezone","messages","MOBILERECURRENCEEDITOR","kendoMobileRecurrenceEditor","pane","value","MOBILEISALLDAYEDITOR","ISALLDAYEDITOR","MOBILETIMEZONEPOPUP","text","timezoneButtonText","noTimezone","closest","on","click","TIMEZONEPOPUP","timezoneEditorButton","MOBILETIMEZONEEDITOR","kendoMobileTimezoneEditor","optionLabel","TIMEZONEEDITOR","visible","toggle","kendoTimezoneEditor","message","startTimezone","endTimezone","attrs","validationRules","fields","validation","validDateRule","validDateValidator","dateCompareRule","dateCompare","wrapDataAccess","originalFunction","convertData","wrapDataSerialization","call","ObservableArray","method","removeUid","event","idx","length","startOffset","endOffset","getTimezoneOffset","end","convert","uid","getTime","getOccurrenceByUid","SchedulerDataReader","Class","init","schema","reader","this","bind","serialize","errors","parse","total","groups","aggregates","applyZone","fromZone","toZone","remove","input","filter","picker","widgetInstance","parseDate","val","format","dateCompareValidator","startInput","find","endInput","startPicker","endPicker","editable","untilDateCompareValidator","untilPicker","until","SchedulerEvent","Model","that","fn","_defaultId","defaults","idField","_time","fieldTime","toUtcTime","_date","clone","updateUid","constructor","toJSON","duration","offset","MS_PER_MINUTE","expand","zone","update","eventInfo","set","_startTime","_endTime","isMultiDay","isException","isNew","recurrenceId","isOccurrence","isRecurring","recurrenceRule","isRecurrenceHead","toOccurrence","recurrenceException","obj","shouldSerialize","key","milliseconds","setTime","type","defaultValue","required","validDate","untilDateCompare","SchedulerDataSource","modelBase","view","apply","logic","filters","operator","Query","expandAll","toArray","cancelChanges","_removeExceptionDate","insert","index","_createNewModel","accept","_pushCreated","_addExceptionDate","pushCreate","items","_removeExceptions","slice","item","shift","head","get","replaceRegExp","RegExp","toExceptionString","replace","test","newException","events","concat","create","dataSource","Error","defaultCommands","className","canceledit","destroy","imageClass","iconClass","trimOptions","overrideOptions","prefix","edit","add","navigate","descriptionEditor","createValidationAttributes","wrap","modelField","specialRules","datatype","inArray","ruleName","rule","isFunction","filterResourceEditorData","editor","parentValue","parentValueField","valueField","editorValue","isMs","valueArray","JSON","stringify","forEach","currentValue","indexOf","splice","trigger","bindParentValueChangeHandler","currentEditor","resource","parent","parentElement","ns","parentWidget","getKendoDropDownList","ev","sender","dataParentValueField","dataValueField","target","filterMobileResourceEditorData","parentSelectedValue","itemParentValue","getter","valid","removeAttribute","setAttribute","dropDownResourceEditor","setTimeout","kendoDropDownList","dataTextField","valuePrimitive","dataColorField","select","e","dataItem","disabled","preventDefault","dataBound","list","each","i","el","element","addClass","dropDownResourceEditorMobile","multiSelectResourceEditor","kendoMultiSelect","itemTemplate","tagTemplate","multiSelectResourceEditorMobile","moveEventRange","distance","editors","mobile","dateRange","timezonePopUp","multipleResources","resources","desktop","Editor","Observable","createButton","toggleDateValidationHandler","_toggleDateValidation","bindAttribute","isDateTimeInput","shouldValidate","is","_initTimezoneEditor","allDayEvent","checkHierarchical","windows_zones","push","repeat","recurrenceEditor","resourceIndex","resourceView","hasParent","some","parentResource","multiple","_buildDesktopEditTemplate","editableFields","settings","Template","templateSettings","paramName","html","renderCheckBox","label","separateTimezones","tmpl","expr","_createEndTimezoneButton","_buildMobileEditTemplate","_buildEditTemplate","isMobile","unescape","_revertTimezones","_startTimezone","_endTimezone","MobileEditor","arguments","Pane","viewEngine","viewOptions","renderOnInit","wrapInSections","detachOnHide","detachOnDestroy","css","height","animations","left","right","close","unbind","timezoneView","content","kSwitch","endTimezoneRow","last","startTimezoneChange","enable","cancel","timezoneTitle","save","append","contentElement","show","stopPropagation","hasClass","editView","_editPane","checked","showDialog","actions","buttons","map","button","action","primary","document","body","kendoDialog","modal","preventScroll","closable","editEvent","updateText","removeText","cancelText","titleText","editorTitle","resetSeries","resetSeriesBtn","deleteBtn","kendoEditable","clearContainer","validateOnBlur","_views","roleSelector","not","views","eq","purge","PopupEditor","deleteText","fieldName","kendoWindow","resizable","draggable","userTriggered","center","open","cycleForm","popup","_timezonePopup","buttonIndex","wrapper","currentTarget","getKendoWindow","activator","checkbox","saveButton","cancelButton","timezonePopup","prop","wnd","timezoneEditorTitle","focus","Scheduler","_initModel","_wrapper","_toolbar","_dataSource","_resources","_resizeHandler","resize","_resizable","_movable","_bindResize","selectable","_tabindex","_navigation","_selectable","_touchHandlers","_ariaId","guid","_createEditor","_unbindResize","off","dataItems","_data","eventsUids","dict","eventsUidsLength","eventsCount","sortedData","_isMobile","mobileOS","_isTouch","originalEvent","pointerType","_isInverseColor","eventElement","_groupsByResource","groupIndex","groupsArray","parentFieldValue","parentField","group","prevIndex","dataIndex","fieldValue","currentGroupIndex","selection","_selection","selectedGroups","selectedEvents","slots","_selectedSlots","_selectedEvents","_resourceBySlot","_old","clearSelection","groupsByResource","groupedResources","_selectEvents","_select","rangeStart","_startDate","rangeEnd","addDays","_endDate","ranges","timeSlotCollectionCount","toLocalDate","isDaySlot","eventsLength","isGrouped","ctrlKey","_ctrlKey","currentGroup","daySlotCollectionCount","collIdx","getTimeSlotCollection","dayCollIdx","getDaySlotCollection","_createSelection","startX","startY","endX","endY","timeStamp","touchMoveHandler","_touchMove","stop","_touchPosX","_tapPosition","_touchPosY","_userTouched","_scrolling","now","_preventFocus","delta","amplitude","_amplitude","_dragging","Math","abs","_mouseDownSelection","kineticScrollNeeded","animate","scrollTop","_mouseDown","_initialFocus","_shiftKey","_keydown","shiftKey","mouseMoveHandler","_mouseMove","which","isRight","_activeElement","focusElement","toolbar","removeClass","_selectFirstSlot","firstAllDay","first","firstContent","firstSlot","_firstEvent","firstEventInAllDay","firstEventInContent","firstEvent","contentEvent","occurrenceByUid","_preventCalendarFocus","calendar","_focusToolbar","current","oldSelection","oldEventsLength","removeAttr","currentUid","uids","coordinate","changedTouches","verticalScroll","scrollHeight","clientHeight","horizontalScroll","scrollWidth","clientWidth","round","scrollLeft","applyVerticalScroll","applyhorizontalScroll","clearTimeout","_moveTimer","slot","selectionByElement","startDate","endDate","backward","_viewByIndex","_keydownToolbar","keyCode","focusableToolBarSelector","focusableItems","shouldNavigate","isRtl","focusedItem","itemToFocus","TAB","altKey","DOWN","_showCalendar","RIGHT","LEFT","_focusedView","ENTER","SPACEBAR","focusedViewName","_selectedViewName","activeElement","_keydownView","isModifier","arrowKeys","UP","previous","cell","DELETE","BACKSPACE","removeEvent","moveToEvent","HOME","END","_scrollTo","_keydownShortcut","currentDate","toggleFullDay","addEvent","timezoneOffset","_keydownYearView","_adjustSelectedDate","_keydownAgendaView","move","_keydownChangeView","viewIndex","viewByIndex","_keydownChangeDate","direction","nextDate","previousDate","shortcutKeys","toolbarIsFocused","ESC","_updateSelection","_updateEventForSelection","_timeSlotInterval","indexOfEvent","autoBind","snap","allDaySlot","min","max","workWeekStart","workWeekEnd","workDays","showWorkHours","startTime","endTime","currentTimeMarker","updateInterval","useLocalTimezone","footer","today","pdf","deleteWindowTitle","next","refresh","selectView","ariaSlotLabel","ariaEventLabel","at","to","allDay","search","day","week","workWeek","agenda","month","timeline","timelineWeek","timelineWorkWeek","timelineMonth","year","recurrenceMessages","resetSeriesWindowTitle","deleteWindowOccurrence","deleteWindowSeries","editWindowTitle","editWindowOccurrence","editWindowSeries","confirmation","width","orientation","_refreshHandler","_progressHandler","_errorHandler","_resourceRefreshHandler","resourceDS","_resourceProgressHandler","_resourceErrorHandler","_editor","_moveDraggable","_resizeDraggable","_model","setDataSource","fetch","_selectedView","siblings","startSlot","endSlot","startResources","clonedEvent","originSlot","originStartTime","clonedEvents","cachedEvents","movable","android","Draggable","ignore","holdToDrag","autoScroll","isTouch","_eventOptionsForMove","inverseColor","evtClone","evtCloneElement","_slotByPosition","x","startLocation","y","location","range","slotIndex","targetSlotElement","children","top","_updateMoveHint","_removeMoveHint","endResources","prevented","_isMultiDrag","evt","updatedEventOptions","eventOptions","_updateEvent","sync","cancelHold","handle","directions","k-resize-e","k-resize-w","k-resize-n","k-resize-s","dragstart","dragHandle","_updateEventForResize","drag","dir","currentSlot","originalStart","originalEnd","_updateResizeHint","dragend","_removeResizeHint","setHours","setMinutes","dragcancel","updateEvent","callback","_preventRefresh","_convertDates","getHours","getMinutes","getSeconds","recurrenceHead","getByUid","updateSeries","updateOccurrence","eventUid","exception","_showRecurringDialog","editRecurring","occurrenceText","seriesText","_modelForContainer","_confirmation","isResetSeries","_isEditorOpened","deleteRecurringConfirmation","deleteSeriesConfirmation","resetSeriesConfirmation","cancelEvent","_editEvent","saveEvent","dirty","_editRecurringDialog","_createPopupEditor","editOccurrence","editSeries","editRecurringMode","_createButton","command","commandName","_set","_attemptRefresh","_deleteRecurringDialog","_removeEvent","occurrence","occurrencesInRange","currentModel","deleteOccurrence","deleteSeries","createException","deleteOccurrenceConfirmation","createExceptionConfirmation","seriesCallback","occurrenceCallback","exeptionCallback","deleteRecurring","_unbindView","angular","elements","_bindView","_viewRemoveHandler","_viewAddHandler","_viewEditHandler","_viewNavigateHandler","isWorkDay","switchWorkDay","_workDayMode","_selectView","_viewActivateHandler","constrainSelection","_renderView","_viewsCount","viewsDropdown","viewButtons","prepend","toLowerCase","viewSelect","rebind","viewName","_initializeView","mouseAndTouchPresent","dateForTitle","shortDateForTitle","mobileDateForTitle","force","size","getSize","currentSize","_size","selectedDate","isInDateRange","setFullYear","getFullYear","getMonth","isSettings","defaultView","selected","hasType","defaultViews","time","resourceFetchArray","_preventRebind","when","then","_requestStart","_error","_progress","progress","resourcePromises","_resourceDataSource","groupName","promises","dataSourceInstance","_bindResourceEvents","isResourceGrouped","_refreshResource","preventRefresh","observable","formattedDate","formattedShortDate","commands","grep","viewsCount","saveAsPDF","throttle","targetElm","anchor","activate","_toggleResize","change","setOptions","depth","copyAnchorStyles","visibleEndDate","refreshLayout","render","slotByPosition","slotByElement","resourcesBySlot","plugin","PDFMixin","SCHEDULER_EXPORT","_drawPDF","styles","style","cssText","scheduler","promise","Deferred","table","_drawPDFShadow","avoidLinks","done","args","page","pageNumber","totalPages","notify","resolve","fail","err","reject","always","TimezoneEditor","zones","zones_titles","_zonesQuery","_zoneTitleId","_zoneTitlePicker","_zonePicker","_zoneTitle","_zone","_value","zoneTitle","DropDownList","cascadeFrom","other_zone","ZONETITLEOPTIONTEMPLATE","ZONEOPTIONTEMPLATE","MobileTimezoneEditor","_bindZones","_filter","_options","_zonePickerLabel","zoneSelect","after","zonePicker","zone_value","amd","a1","a2","a3"],"mappings":"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"}